var Se=Object.defineProperty;var V=Object.getOwnPropertySymbols;var be=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable;var K=(e,s,t)=>s in e?Se(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,G=(e,s)=>{for(var t in s||(s={}))be.call(s,t)&&K(e,t,s[t]);if(V)for(var t of V(s))Ce.call(s,t)&&K(e,t,s[t]);return e};import{I as C,C as I,M as $e,R as ke,a as q,o as g,d as M,c as v,g as p,l as $,L as D,b as Le,e as E,m as A,f as z,D as Q,h as xe,i as J,s as L,A as X,j as Y,k as Me,n as Z,p as Fe,T as je,q as Ie,r as De,t as Ee,u as ze,v as Te,w as Ae,x as Be,y as Re}from"./main.288f124c.js";import{n as d,_ as r,V as ee,s as Ne,a as Oe,c as Pe,b as He,d as We,e as Ue}from"./vendor.4eff9dfb.js";var Ve=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"mappingTypes",on:{mouseover:function(i){e.hovered=!0},mouseout:function(i){e.hovered=!1}}},e._l(e.mappingTypes,function(i){return t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.right",value:{title:e.$jskos.prefLabel(i)+e.definition(i),delay:e.defaults.delay.medium},expression:"{ title: $jskos.prefLabel(mappingType) + definition(mappingType), delay: defaults.delay.medium }",modifiers:{hover:!0,right:!0}}],key:i.uri,staticClass:"mappingType",class:{mappingTypeSelected:e.hovered&&i&&e.mappingTypeSelected&&i.uri==e.mappingTypeSelected.uri,"fontWeight-heavy":i&&e.mappingTypeSelected&&i.uri==e.mappingTypeSelected.uri,mappingTypeHovered:i&&e.mappingTypeHovered&&i.uri==e.mappingTypeHovered.uri},style:"display: "+(i&&e.mappingTypeSelected&&i.uri==e.mappingTypeSelected.uri||e.hovered?"inline-block":"none")+";",on:{click:function(n){return e.choose(i)}}},[e._v(" "+e._s(e.$jskos.notation(i))+" ")])}),0)},Ke=[];const Ge={name:"MappingTypeSelection",props:{mapping:{type:Object,default:null}},data(){return{hovered:!1,mappingTypes:this.$jskos.mappingTypes,mappingTypeHovered:null}},computed:{mappingTypeSelected(){let e=this.mapping;return this.$jskos.mappingTypeByType(e?e.type:null)}},methods:{choose(e){this.$store.commit({type:"mapping/setType",uri:e.uri})},definition(e){let s=this.$jskos.definition(e);return s.length?": "+s.join(", "):""}}},te={};var qe=d(Ge,Ve,Ke,!1,Qe,"4bac7e57",null,null);function Qe(e){for(let s in te)this[s]=te[s]}var Je=function(){return qe.exports}(),B={data(){return{hotkeys:[]}},methods:{shortcutHandler(){},enableShortcuts(){let e=this.$options.name,s=0;for(let t of this.config.shortcuts||[])t.component===e&&(this.addHotkey(t.keys,()=>{this.shortcutHandler(t)}),s+=1);s&&document.addEventListener("keydown",this.hotkeyHandler)},hotkeyHandler(e){let s=r.pick(e,["key","keyCode","metaKey","ctrlKey","altKey","shiftKey"]);if(r.get(e,"srcElement.tagName")=="INPUT"){let n=[{key:"a",ctrlKey:!0,metaKey:!1,altKey:!1,shiftKey:!1},{key:"a",ctrlKey:!1,metaKey:!0,altKey:!1,shiftKey:!1},{key:"\xB5",ctrlKey:!1,metaKey:!1,altKey:!0,shiftKey:!1}],o=!1;for(let a of n){const l=a.key?"keyCode":"key";if(r.isEqual(r.omit(a,[l]),r.omit(s,[l]))){o=!0;break}}if(o)return}let t=!0;if(document.getElementsByClassName("modal show").length==0)for(let n of this.hotkeys){const o=n.shortcut.key?"keyCode":"key";r.isEqual(r.omit(s,[o]),r.omit(n.shortcut,[o]))&&(t=n.handler()&&t)}t||(e.stopPropagation(),e.preventDefault(),e.returnValue=!1,e.cancelBubble=!0)},addHotkey(e,s){e=e.split(",");for(let t of e){let i=t.split("+"),n=null,o=null,a=!1,l=!1,c=!1,h=!1;for(let m of i)m=="ctrl"?l=!0:m=="alt"||m=="option"?c=!0:m=="meta"||m=="command"?a=!0:m=="shift"?h=!0:m.startsWith("keyCode:")?o=parseInt(m.replace("keyCode:","")):n=m;this.hotkeys.push({handler:s,shortcut:{key:n,keyCode:o,metaKey:a,ctrlKey:l,altKey:c,shiftKey:h}})}}}},Xe=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{attrs:{id:"mappingEditor"}},[t("component-settings",{attrs:{tooltip:e.$t("mappingEditor.settingsButton")}}),e.canSaveCurrentMapping||e.canExportCurrentMapping&&!e.hasChangedFromOriginal?t("div",{class:{"mappingEditor-mappingNotSaved":e.canSaveCurrentMapping,"mappingEditor-mappingSaved":e.canExportCurrentMapping&&!e.hasChangedFromOriginal,"fontSize-small":!0,"fontWeight-heavy":!0}},[t("registry-info",{attrs:{registry:e.$store.getters.getCurrentRegistry,"show-details":!1,"show-capabilities":!1,"show-editable":!1,inline:!0}}),e._v(": "+e._s(e.$t(e.canSaveCurrentMapping?"mappingEditor.notSaved":"mappingEditor.saved"))+" ")],1):e._e(),t("div",{staticClass:"mappingEditorToolbar"},[t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.canSwapCurrentMapping?e.$t("mappingEditor.swapMapping"):"",delay:e.defaults.delay.medium},expression:"{ title: canSwapCurrentMapping ? $t('mappingEditor.swapMapping') : '', delay: defaults.delay.medium }",modifiers:{hover:!0}}],staticClass:"mappingEditorToolbarItem",class:{button:e.canSwapCurrentMapping,"button-disabled":!e.canSwapCurrentMapping},on:{click:e.swapMapping}},[t("font-awesome-icon",{attrs:{icon:"exchange-alt"}})],1),t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.canSaveCurrentMapping?e.$t("mappingEditor.saveMapping",[e.$jskos.prefLabel(e.currentRegistry)]):"",delay:e.defaults.delay.medium},expression:"{ title: canSaveCurrentMapping ? $t('mappingEditor.saveMapping', [$jskos.prefLabel(currentRegistry)]) : '', delay: defaults.delay.medium }",modifiers:{hover:!0}}],staticClass:"mappingEditorToolbarItem",class:{button:e.canSaveCurrentMapping,"button-disabled":!e.canSaveCurrentMapping},on:{click:e.saveCurrentMapping}},[t("font-awesome-icon",{attrs:{icon:"save"}})],1),t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.canDeleteCurrentMapping?e.$t("mappingEditor.deleteMapping"):e.$store.getters.getCurrentRegistry&&(!e.$store.getters.getCurrentRegistry.has.auth||e.$store.getters.getCurrentRegistry.auth)?"":e.$t("general.authNecessary"),delay:e.defaults.delay.medium},expression:"{ title: canDeleteCurrentMapping ? $t('mappingEditor.deleteMapping') : ($store.getters.getCurrentRegistry && (!$store.getters.getCurrentRegistry.has.auth || $store.getters.getCurrentRegistry.auth) ? '' : $t('general.authNecessary')), delay: defaults.delay.medium }",modifiers:{hover:!0}}],staticClass:"mappingEditorToolbarItem",class:{"button-delete":e.canDeleteCurrentMapping,"button-disabled":!e.canDeleteCurrentMapping},on:{click:e.deleteCurrentMapping}},[t("font-awesome-icon",{attrs:{icon:"trash-alt"}})],1),t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.canCloneCurrentMapping?e.$t("mappingEditor.cloneMapping"):"",delay:e.defaults.delay.medium},expression:"{ title: canCloneCurrentMapping ? $t('mappingEditor.cloneMapping') : '', delay: defaults.delay.medium }",modifiers:{hover:!0}}],staticClass:"mappingEditorToolbarItem",class:{button:e.canCloneCurrentMapping,"button-disabled":!e.canCloneCurrentMapping},on:{click:e.cloneMapping}},[t("font-awesome-icon",{attrs:{icon:"clone"}})],1),t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.canClearCurrentMapping?e.$t("mappingEditor.clearMapping"):"",delay:e.defaults.delay.medium},expression:"{ title: canClearCurrentMapping ? $t('mappingEditor.clearMapping') : '', delay: defaults.delay.medium }",modifiers:{hover:!0}}],staticClass:"mappingEditorToolbarItem",class:{button:e.canClearCurrentMapping,"button-disabled":!e.canClearCurrentMapping},on:{click:e.clearMapping}},[t("font-awesome-icon",{attrs:{icon:"ban"}})],1),t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip",value:{title:e.mappingStatus.message||"",placement:"bottom"},expression:`{
        title: mappingStatus.message || '',
        placement: 'bottom'
      }`}],staticClass:"mappingEditorToolbarItem mappingEditor-mappingAlert fontWeight-heavy",class:{"text-warning":e.mappingStatus.warning,"text-danger":e.mappingStatus.invalid}},[e.$jskos.conceptsOfMapping(e.mapping).length>0&&e.mappingStatus.message?t("font-awesome-icon",{attrs:{icon:"exclamation-circle"}}):e._e()],1)]),e._l([!0,!1],function(i,n){return t("div",{key:n,staticClass:"mappingEditorPart",class:{"mappingEditorPart-noConcepts":e.$store.getters["mapping/getScheme"](i)==null||!e.$store.getters["mapping/getConcepts"](i).length,"mappingEditorPart-dropTarget":e.$store.state.draggedConcept!=null},style:{order:n*2},on:{dragover:e.dragOver,drop:function(o){return e.drop(o,i)}}},[e.$store.getters["mapping/getScheme"](i)!=null&&e.$store.getters["mapping/getConcepts"](i).length?t("div",[t("div",{staticClass:"mappingScheme fontWeight-heavy"},[t("item-name",{attrs:{item:e.$store.getters["mapping/getScheme"](i),"is-link":!0,"is-left":i,"show-text":!1}})],1),t("div",{staticClass:"mappingConceptList"},[t("div",[t("div",{staticStyle:{flex:"1"}}),t("ul",e._l(e.$store.getters["mapping/getConcepts"](i),function(o,a){return t("li",{key:a},[t("item-name",{attrs:{item:o,"is-link":!0,"is-left":i,"is-highlighted":e.$jskos.compare(o,e.selected.concept[!0])||e.$jskos.compare(o,e.selected.concept[!1]),"show-popover":!0,"font-size":"large"}}),t("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.$t("mappingEditor.removeConceptFromMapping"),delay:e.defaults.delay.medium},expression:"{ title: $t('mappingEditor.removeConceptFromMapping'), delay: defaults.delay.medium }",modifiers:{hover:!0}}],staticClass:"button fontSize-large",on:{click:function(l){return e.$store.commit({type:"mapping/remove",concept:o,isLeft:i})}}},[t("font-awesome-icon",{attrs:{icon:"times-circle"}})],1)],1)}),0),t("div",{staticStyle:{flex:"1"}})])])]):t("div",[t("div",{staticClass:"mappingNoConcepts"},[e.$store.state.draggedConcept==null?t("div",{staticStyle:{"margin-bottom":"-12px"}},[e._v(" "+e._s(e.$t("mappingEditor.placeholder"))),t("br"),t("br")]):t("div",{staticClass:"fontWeight-heavy"},[e._v(" "+e._s(e.$t("mappingEditor.placeholderDragging"))+" ")]),e.$store.state.draggedConcept==null?t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.isAddButtonEnabled(i)?e.$t("general.addToMapping"):"",delay:e.defaults.delay.medium},expression:"{ title: isAddButtonEnabled(isLeft) ? $t('general.addToMapping') : '', delay: defaults.delay.medium }",modifiers:{hover:!0}}],staticClass:"mappingEditor-addButton",class:{button:e.isAddButtonEnabled(i),"button-disabled":!e.isAddButtonEnabled(i)},on:{click:function(o){return e.addToMappingInternal(i)}}},[t("font-awesome-icon",{attrs:{icon:"plus-circle"}})],1):e._e()])])])}),t("div",{staticClass:"mappingTypeSelection"},[t("mapping-type-selection",{attrs:{mapping:e.$store.state.mapping.mapping}})],1),t("div",{staticClass:"mappingEditor-title"},[e._v(" "+e._s(e.$t("mappingEditor.title"))+" "),e.currentGuidelines?t("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.$t("mappingEditor.guidelines"),delay:e.defaults.delay.medium},expression:"{ title: $t('mappingEditor.guidelines'), delay: defaults.delay.medium }",modifiers:{hover:!0}}]},[t("a",{attrs:{href:e.currentGuidelines.url,target:"_blank"}},[t("font-awesome-icon",{attrs:{icon:"question-circle"}})],1)]):e._e()]),t("b-modal",{ref:"deleteModal",attrs:{title:e.$t("mappingEditor.deleteTitle"),"hide-footer":""}},[t("p",{staticStyle:{"text-align":"center"}},[e._v(" "+e._s(e.$t("mappingEditor.deleteText"))+" "),e.hasChangedFromOriginal?t("span",[t("br"),e._v(e._s(e.$t("mappingEditor.deleteChangesText"))+" ")]):e._e()]),t("div",{staticClass:"mappingEditor-deleteButtons"},[t("b-button",{attrs:{variant:"danger"},on:{click:function(i){e.deleteOriginalMapping(!0)&&e.$refs.deleteModal.hide()}}},[e._v(" "+e._s(e.$t("mappingEditor.deleteConfirm"))+" ")]),t("b-button",{attrs:{variant:"secondary"},on:{click:function(i){return e.$refs.deleteModal.hide()}}},[e._v(" "+e._s(e.$t("mappingEditor.cancel"))+" ")])],1)]),t("mapping-detail",{ref:"mappingDetail",attrs:{mapping:e.mapping}}),t("div",{staticClass:"mappingEditor-infoIcon"},[t("font-awesome-icon",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.$t("mappingBrowser.showDetail"),delay:e.defaults.delay.medium},expression:"{ title: $t('mappingBrowser.showDetail'), delay: defaults.delay.medium }",modifiers:{hover:!0}}],staticClass:"button",attrs:{icon:"info-circle"},on:{click:function(i){return e.$refs.mappingDetail.show()}}})],1)],2)},Ye=[];const Ze={name:"MappingEditor",components:{ItemName:C,MappingTypeSelection:Je,ComponentSettings:I,MappingDetail:$e,RegistryInfo:ke},mixins:[q,g,M,B,v],computed:{mapping(){return this.$store.state.mapping.mapping},original(){return this.$store.state.mapping.original},canSaveCurrentMapping(){return this.mappingStatus.invalid?!1:this.$store.getters["mapping/canUpdate"]?this.hasChangedFromOriginal:this.$store.getters["mapping/canCreate"]},canDeleteCurrentMapping(){return this.$store.getters["mapping/canDelete"]},canClearCurrentMapping(){return this.mapping.fromScheme||this.mapping.toScheme},canExportCurrentMapping(){return this.mapping.fromScheme&&this.mapping.toScheme},canSwapCurrentMapping(){return this.$jskos.conceptsOfMapping(this.mapping,"to").length<=1&&this.$jskos.conceptsOfMapping(this.mapping).length>0},canCloneCurrentMapping(){return this.original.uri!=null},mappingStatus(){const e=this.currentRegistry;if(!e)return{message:this.$t("mappingEditor.warningNoRegistry"),invalid:!1,warning:!0};if(this.schemeRight&&!this.mapping.fromScheme&&this.$store.commit({type:"mapping/setScheme",isLeft:!1,scheme:this.schemeRight}),!e.isAuthorizedFor({type:"mappings",action:"create",user:this.user}))return{message:this.$t("registryInfo.notAuthenticated")+` (${this.$jskos.prefLabel(e)})`,invalid:!0};for(let t of["fromScheme","toScheme"])if(!this.mapping[t])return{message:this.$t("mappingEditor.invalidMissing",[t]),invalid:!0};if(this.$jskos.conceptsOfMapping(this.mapping,"from").length===0)return{message:this.$t("mappingEditor.invalidMissing",["from"]),invalid:!0};for(let t of["fromScheme","toScheme"]){const i=r.get(e,`config.mappings.${t}Whitelist`);if(i&&!i.find(n=>this.$jskos.compare(n,this.mapping[t])))return{message:this.$t("mappingEditor.invalidWhitelist",[`${t} ${this.$jskos.prefLabel(this.mapping[t],{fallbackToUri:!1})||""}`,this.$jskos.prefLabel(e)]),invalid:!0}}if(r.get(e,"config.mappings.cardinality")=="1-to-1"&&this.$jskos.conceptsOfMapping(this.mapping,"to").length>1)return{message:this.$t("mappingEditor.invalid1to1",[this.$jskos.prefLabel(e)]),invalid:!0};if(this.original.uri&&!this.$jskos.compareFast(e,this.original.registry))return{message:this.$t("mappingEditor.warningUpdateRegistry",[this.$jskos.prefLabel(this.original.registry),this.$jskos.prefLabel(e)]),warning:!0};if(this.original.uri&&!this.$store.getters["mapping/canUpdate"])return{message:this.$t("mappingEditor.warningUpdateNotAllowed"),warning:!0};for(let t of["fromScheme","toScheme"])if(this.original.uri&&!this.$jskos.compare(this.mapping[t],this.original.mapping[t]))return{message:this.$t("mappingEditor.warningUpdateScheme",[t]),warning:!0};return{message:null,invalid:!1,warning:!1}},mappingEncoded(){return encodeURIComponent(JSON.stringify(this.prepareMapping()))},hasChangedFromOriginal(){return this.$store.getters["mapping/hasChangedFromOriginal"]},schemeRight(){return this.selected.scheme[!1]},currentGuidelines(){return(this.config.guidelines||[]).find(e=>this.$jskos.compare(e.fromScheme,this.selected.scheme[!0])&&this.$jskos.compare(e.toScheme,this.selected.scheme[!1]))}},watch:{mappingEncoded(){let e=r.get(this.$el.parentElement.getElementsByClassName("minimizer"),"[0].__vue__");e&&e.toggleMinimize(!1),this.$store.commit({type:"mapping/setScheme",isLeft:!1,scheme:this.selected.scheme[!1]})},schemeRight(){this.$store.commit({type:"mapping/setScheme",isLeft:!1,scheme:this.selected.scheme[!1]})},creator(){this.setCreator()},"original.uri"(){this.setCreator()}},mounted(){this.enableShortcuts(),this.setCreator()},methods:{shortcutHandler({action:e,isLeft:s}){switch(e){case"saveMapping":this.saveCurrentMapping();break;case"clearMapping":this.clearMapping();break;case"addConcept":this.addToMappingInternal(s);break}},async saveCurrentMapping(){if(!this.canSaveCurrentMapping)return!1;this.creator?this.setCreator():this.removeCreator();const e=this.original.uri&&this.$jskos.compareFast(this.currentRegistry,this.original.registry),s=await this[e?"putMapping":"postMapping"]({registry:this.currentRegistry,mapping:this.mapping,_before:()=>{this.loadingGlobal=!0},_after:()=>{this.loadingGlobal=!1}});this.$store.commit({type:"mapping/set",original:s}),this.componentSettings.clearOnSave&&this.clearMapping()},setCreator(){let e=(this.mapping.contributor||[]).concat((this.mapping.creator||[]).filter(t=>!(this.creator.uri&&t.uri&&this.creator.uri==t.uri)&&!(this.creatorName&&this.$jskos.prefLabel(t,{fallbackToUri:!1})&&this.creatorName==this.$jskos.prefLabel(t,{fallbackToUri:!1})))),s=[this.creator];this.$store.commit({type:"mapping/setCreator",creator:s}),this.$store.commit({type:"mapping/setContributor",contributor:e})},removeCreator(){let e=(this.mapping.contributor||[]).concat(this.mapping.creator||[]);this.$store.commit({type:"mapping/setCreator",creator:null}),this.$store.commit({type:"mapping/setContributor",contributor:e})},deleteCurrentMapping(){return this.canDeleteCurrentMapping?(this.$refs.deleteModal.show(),!0):!1},async deleteOriginalMapping(e=!1){return await this.deleteMapping({mapping:this.mapping,_before:()=>{this.loadingGlobal=!0},_after:()=>{this.loadingGlobal=!1}}),e&&this.clearMapping(),!0},clearMapping(){return this.canClearCurrentMapping?(this.$store.commit({type:"mapping/empty"}),!0):!1},labelForScheme(e){return this.$jskos.notation(p(e),"scheme")},isAddButtonEnabled(e){return this.$store.getters["mapping/canAdd"](this.selected.concept[e],this.selected.scheme[e],e)},isDeleteAllButtonEnabled(e){return this.$store.getters["mapping/getConcepts"](e).length>0},addButtonDisabledReason(e){let s=e?this.selected.concept[!0]:this.selected.concept[!1];return this.$store.getters["mapping/checkScheme"](e?this.selected.scheme[!0]:this.selected.scheme[!1],e)?s==null?"Please select a concept.":this.$store.getters["mapping/added"](s,e)?"Selected concept is already in mapping.":"Other reason.":"Scheme does not match."},addToMappingInternal(e){if(!this.isAddButtonEnabled(e))return;let s=e?this.selected.concept[!0]:this.selected.concept[!1];this.addToMapping({concept:s,scheme:this.selected.scheme[e],isLeft:e})},deleteAll(e){this.$store.commit({type:"mapping/removeAll",isLeft:e})},droppedConcept(e,s){this.$jskos.isConcept(e)&&(this.addToMapping({concept:e,scheme:e.inScheme&&e.inScheme[0]||this.selected.scheme[s],isLeft:s}),$([e]))},swapMapping(){!this.canSwapCurrentMapping||this.$store.commit({type:"mapping/switch"})},cloneMapping(){let e=this.$jskos.copyDeep(this.mapping);delete e.uri,this.$store.commit({type:"mapping/set",original:null}),this.$store.commit({type:"mapping/set",mapping:e})}}},ie={};var et=d(Ze,Xe,Ye,!1,tt,"1edcf2dd",null,null);function tt(e){for(let s in ie)this[s]=ie[s]}var it=function(){return et.exports}(),st=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"minimizer"},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.minimized,expression:"!minimized"},{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.$t("minimizer.minimize"),delay:e.defaults.delay.medium},expression:"{ title: $t('minimizer.minimize'), delay: defaults.delay.medium }",modifiers:{hover:!0}}],staticClass:"utilityButton minimizeButton",on:{click:function(i){return e.toggleMinimize()},mouseover:function(i){e.minimizeHovered=!0},mouseout:function(i){e.minimizeHovered=!1}}},[t("font-awesome-icon",{attrs:{icon:"window-minimize"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.minimized,expression:"minimized"}],staticClass:"minimizedOverlay",on:{click:function(i){return e.toggleMinimize()}}},[t("div",[e._v(" "+e._s(e.text)+" "),t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.$t("minimizer.maximize"),delay:e.defaults.delay.medium},expression:"{ title: $t('minimizer.maximize'), delay: defaults.delay.medium }",modifiers:{hover:!0}}],staticClass:"maximizeButton"},[t("font-awesome-icon",{attrs:{icon:"plus-square"}})],1)])]),e.minimizeHovered?t("div",{staticClass:"minimizedHoverOverlay"}):e._e()])},nt=[];const ot={name:"Minimizer",mixins:[v],props:{name:{type:String,default:null},text:{type:String,default:""},isColumn:{type:Boolean,default:!1},forceMinimized:{type:Boolean,default:null}},data(){return{previousFlex:"",previousMinSizes:[],minimizedLocal:!1,minimizerSize:"40px",minimizeHovered:!1}},computed:{minimized:{get(){return this.forceMinimized!=null?this.forceMinimized:this.name!=null?this.$settings.minimized[this.name]||!1:this.minimizedLocal},set(e){if(this.name!=null){let s=r.cloneDeep(this.$settings.minimized);s[this.name]=e,this.$store.commit({type:"settings/set",prop:"minimized",value:s})}else this.minimizedLocal=e}}},watch:{minimized(){this.refreshMinimize()}},mounted(){this.refreshMinimize()},methods:{toggleMinimize(e=null){e!=null?this.minimized=e:this.minimized=!this.minimized},refreshMinimize(){this.minimized&&(this.previousMinSizes=[]);let e=this.$el;for(;!e.classList.contains("mainComponent");)if(e=e.parentElement,this.minimized){let t=window.getComputedStyle(e),i;this.isColumn?i=t.getPropertyValue("min-width"):i=t.getPropertyValue("min-height"),this.previousMinSizes.push({element:e,minSize:i}),this.isColumn?(e.style.minWidth=this.minimizerSize,e.style.maxWidth=this.minimizerSize):(e.style.minHeight=this.minimizerSize,e.style.maxHeight=this.minimizerSize)}let s=window.getComputedStyle(e);if(this.minimized){e.classList.add("mainComponent-minimized"),this.previousFlex=s.getPropertyValue("flex"),e.style.flex="0 1 "+this.minimizerSize,e.dataset.minimized=1,this.refresh("minimize");let t=window.getComputedStyle(this.$el.getElementsByClassName("minimizedOverlay")[0]).getPropertyValue("z-index");for(let i of e.getElementsByClassName("minimizer"))i!=this.$el&&i.__vue__.minimized&&window.getComputedStyle(i.getElementsByClassName("minimizedOverlay")[0]).getPropertyValue("z-index")>=t&&(i.getElementsByClassName("minimizedOverlay")[0].style.zIndex=t-1)}else{e.classList.remove("mainComponent-minimized"),e.style.flex=this.previousFlex;for(let t of this.previousMinSizes)this.isColumn?(t.element.style.minWidth=t.minSize,t.element.style.maxWidth=""):(t.element.style.minHeight=t.minSize,t.element.style.maxHeight="");e.dataset.minimized=0,this.refresh("minimize")}}}},se={};var rt=d(ot,st,nt,!1,at,"7aa35c03",null,null);function at(e){for(let s in se)this[s]=se[s]}var R=function(){return rt.exports}(),lt=function(){var e=this,s=e.$createElement,t=e._self._c||s;return e.concept!=null?t("div",{staticClass:"conceptListItem",class:{hovered:e.isHovered&&!e.isHovered,selected:e.isSelected,"concept-mappingsExist":e.showConceptMappedStatus&&e.mappedStatus,"concept-mappingsDoNotExist":e.showConceptMappedStatus&&!e.mappedStatus},style:"padding-left: "+e.depth*10+"px",attrs:{"data-uri":e.concept.uri},on:{mouseover:function(i){return e.hovering(e.concept)},mouseout:function(i){return e.hovering(null)}}},[t("div",{staticClass:"conceptBox",attrs:{draggable:"true"},on:{dragstart:function(i){return e.dragStart(e.concept,i)},dragend:function(i){return e.dragEnd()}}},[e.showChildren&&e.hasChildren?t("div",{staticClass:"arrowBox",on:{click:function(i){return e.openByArrow(!e.isOpen)}}},[t("i",{class:{right:!e.isOpen,down:e.isOpen}})]):e._e(),e._l(e.buttons.filter(function(i){return i.position=="before"}),function(i,n){return t("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:i.tooltip,delay:e.defaults.delay.medium},expression:"{ title: button.tooltip, delay: defaults.delay.medium}",modifiers:{hover:!0}}],key:"conceptListItem-buttons-"+n,staticClass:"button fontSize-verySmall conceptListItem-buttonBefore",on:{click:function(o){return i.onClick(o,e.concept)}}},[t("font-awesome-icon",{attrs:{icon:i.icon}})],1)}),t(e.url?"router-link":"div",{tag:"div",staticClass:"labelBox",class:{labelBoxFull:e.showChildren&&!e.hasChildren,labelBoxSelected:e.isSelected,labelBoxSingle:!e.showChildren},attrs:{to:e.url},on:{click:function(i){return i.stopPropagation(),i.preventDefault(),e.onClick.apply(null,arguments)}}},[e.scheme&&e.showScheme?t("span",[e._v(" "+e._s(e.$jskos.notation(e.scheme))+" ")]):e._e(),e.concept&&e.concept.__DETAILSLOADED__==-1?t("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.$t("itemDetail.unknownConcept"),delay:e.defaults.delay.medium},expression:"{ title: $t('itemDetail.unknownConcept'), delay: defaults.delay.medium }",modifiers:{hover:!0}}],staticClass:"fontSize-small"},[t("font-awesome-icon",{attrs:{icon:"bolt"}})],1):e._e(),e.concept&&e.concept.type&&e.concept.type.includes("http://rdf-vocabulary.ddialliance.org/xkos#CombinedConcept")?t("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.$t("itemDetail.combinedConcept"),delay:e.defaults.delay.medium},expression:"{ title: $t('itemDetail.combinedConcept'), delay: defaults.delay.medium }",modifiers:{hover:!0}}],staticClass:"fontSize-normal"},[t("font-awesome-icon",{attrs:{icon:"puzzle-piece"}})],1):e._e(),t("span",{staticClass:"fontWeight-heavy",domProps:{innerHTML:e._s(e.notation)}}),t("span",{class:{"fontWeight-medium":!0}},[e._v(" "+e._s(e.prefLabel)+" ")])]),e.canAddToMapping?t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.$t("general.addToMapping"),delay:e.defaults.delay.medium},expression:"{ title: $t('general.addToMapping'), delay: defaults.delay.medium}",modifiers:{hover:!0}}],staticClass:"button addToMapping",on:{click:function(i){return e.addConcept()}}},[t("font-awesome-icon",{attrs:{icon:"plus-circle"}})],1):e._e()],2),e.showChildren&&e.hasChildren&&e.isOpen&&e.concept.narrower&&e.concept.narrower.includes(null)?t("loading-indicator",{staticStyle:{"margin-left":"36px"},attrs:{size:"sm"}}):e._e()],1):e._e()},ct=[];const pt={name:"ConceptListItem",components:{LoadingIndicator:D,ItemName:C},mixins:[g,M],props:{source:{type:Object,default:null},index:{type:Number,default:null},isLeft:{type:Boolean,default:!0},showChildren:{type:Boolean,default:!1},showScheme:{type:Boolean,default:!1},buttons:{type:Array,default:()=>[]}},data(){return{isHoveredFromHere:!1,loadingChildren:!1,preventClick:!1,preventClickArrow:!1,canAddToMapping:!1,interval:null,url:null}},computed:{hasChildren(){return r.get(this.concept,"narrower.length",1)!=0},isHovered(){return this.isHoveredFromHere},childrenLoaded(){return!this.concept.narrower||!this.concept.narrower.includes(null)},isOpen(){return r.get(this.concept,`__ISOPEN__[${this.isLeft}]`,!1)},scheme(){return r.get(this.concept,"inScheme[0]")},mappedStatus(){return this.$store.getters.mappedStatus(this.concept,this.isLeft)},showConceptMappedStatus(){return this.$store.state.settings.settings.components.ConceptListWrapper.loadConceptsMappedStatus},concept(){return p(this.source.concept)||this.source.concept},depth(){return this.source.depth},isSelected(){return this.source.isSelected},notation(){return this.getNotation(this.concept,"concept",!0)},prefLabel(){let e=this.getPrefLabel(this.concept);return e===""&&this.notation===""?this.concept.uri:e}},created(){this.hovering=r.debounce(this._hovering,20)},methods:{_hovering(e){this.$store.commit({type:"setHoveredConcept",concept:e}),this.isHoveredFromHere=e!=null,this.canAddToMapping=this.$store.getters["mapping/canAdd"](this.concept,this.$store.state.selected.scheme[this.isLeft],this.isLeft),window.clearInterval(this.interval),e!=null&&(this.interval=setInterval(()=>{this.isMouseOver()||(this.isHoveredFromHere=!1,window.clearInterval(this.interval))},500)),e?this.url=this.getRouterUrl(e,this.isLeft,!0):this.url=null},openByArrow(e){this.preventClickArrow||(this.open(this.concept,this.isLeft,e),this.loadChildren(),this.preventClickArrow=!0,r.delay(()=>{r.delay(()=>{this.preventClickArrow=!1},200)},50))},select(e){this.setSelected({isLeft:this.isLeft,concept:e})},onClick(){this.preventClick||this.isSelected&&this.hasChildren&&(this.preventClick=!0,r.delay(()=>{this.open(this.concept,this.isLeft,!this.isOpen),r.delay(()=>{this.preventClick=!1},200)},50))},addConcept(){!this.isSelected&&this.$store.state.settings.settings.components.ConceptListWrapper.addToMappingSelectsConcept&&this.select(this.concept),this.addToMapping({concept:this.concept,scheme:this.$store.state.selected.scheme[this.isLeft],isLeft:this.isLeft})},loadChildren(){this.loadingChildren=!0,Le(this.concept).then(()=>{this.loadingChildren=!1,this.showChildren&&this.concept&&this.concept.__ISOPEN__&&this.concept.__ISOPEN__[this.isLeft]&&this.scrollTo()})},scrollTo(){let e=this.$el.parentElement;for(;!e.classList.contains("scrollable")&&e.parentElement;)e=e.parentElement;var s={container:e,easing:"ease-in",offset:-20,cancelable:!0,x:!1,y:!0};this.$scrollTo(this.$el,200,s)}}},ne={};var ht=d(pt,lt,ct,!1,ut,"442e7609",null,null);function ut(e){for(let s in ne)this[s]=ne[s]}var dt=function(){return ht.exports}(),T={mixins:[g],computed:{loadConceptsMappedStatus(){return this.$store.state.settings.settings.components.ConceptListWrapper.loadConceptsMappedStatus},loadConceptsMappedStatusOtherScheme(){return r.isBoolean(this.isLeft)?this.$store.state.selected.scheme[!this.isLeft]:null}},created(){this.loadMappingsForConcepts=r.debounce(this._loadMappingsForConcepts,300)},watch:{loadConceptsMappedStatusConceptsToLoad(){this.loadMappingsForConcepts(this.loadConceptsMappedStatusConceptsToLoad||[])},currentRegistry(){this.loadMappingsForConcepts(this.loadConceptsMappedStatusConceptsToLoad||[])},loadConceptsMappedStatusOtherScheme(){this.loadMappingsForConcepts(this.loadConceptsMappedStatusConceptsToLoad||[])},loadConceptsMappedStatus(){this.loadMappingsForConcepts(this.loadConceptsMappedStatusConceptsToLoad||[])}},methods:{_loadMappingsForConcepts(e){if(!this.loadConceptsMappedStatus)return;const s=this.currentRegistry,t=this.loadConceptsMappedStatusOtherScheme;e=E(e.filter(n=>!r.get(n,"__MAPPED__",[]).find(o=>this.$jskos.compareFast(o.registry,s)&&this.$jskos.compare(o.scheme,t))));const i=e.map(n=>n.uri);t&&i.length&&s&&Promise.all(r.chunk(i,15).map(n=>this.getMappings({from:n.join("|"),toScheme:t.uri,direction:"both",registry:s.uri,limit:500}))).then(()=>{for(let n of e.filter(o=>!r.get(o,"__MAPPED__",[]).find(a=>this.$jskos.compareFast(a.registry,s)&&this.$jskos.compare(a.scheme,t))))A(n,"__MAPPED__",[]),n.__MAPPED__.push({registry:s,scheme:t,exist:[]})})}}},mt=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"conceptList"},[t("virtual-list",{ref:"conceptListItems",staticClass:"conceptListItems",attrs:{"data-key":"uri","data-sources":e.items,"data-component":e.itemComponent,keeps:70,"extra-props":{isLeft:e.isLeft,showChildren:e.showChildren,showScheme:e.showScheme,buttons:e.buttons},"wrap-style":{"margin-top":"5px","margin-bottom":"15px"}},nativeOn:{scroll:function(i){return e.$emit("scroll")}}}),e.noItems?t("div",{staticClass:"conceptListItems-noItems"},[e._v(" "+e._s(e.noItemsLabel||e.$t("conceptList.noItems"))+" ")]):e._e(),e.loading||e.concepts.includes(null)?t("loading-indicator-full"):e._e()],1)},ft=[];const gt={name:"ConceptList",components:{LoadingIndicatorFull:z,VirtualList:ee},mixins:[g,v,T],props:{isLeft:{type:Boolean,default:!0},concepts:{type:Array,default:()=>[null]},showChildren:{type:Boolean,default:!1},noItemsLabel:{type:String,default:null},showScheme:{type:Boolean,default:!1},buttons:{type:Array,default:()=>[]},shown:{type:Boolean,default:!1}},emits:["scroll"],data(){return{loading:!1,currentSelectedConcept:null,shouldScroll:!0,scrollTo:Ne(),itemComponent:dt}},computed:{conceptSelected(){return this.selected.concept[this.isLeft]},conceptSelectedFromStore(){return p(this.selected.concept[this.isLeft])},items(){if(!this.shown)return[];let e=[];for(let s of this.concepts){let t={uri:s?s.uri:"loading",concept:s,depth:0,isSelected:this.$jskos.compareFast(this.conceptSelected,s)};if(e.push(t),this.showChildren){let i=this.children(t);e=e.concat(i)}}return e},noItems(){return this.items.length==0&&!this.loading},otherScheme(){return p(this.selected.scheme[!this.isLeft])}},watch:{conceptSelectedFromStore:{handler(){this.conceptSelectedUpdated()},deep:!0},shown(){this.conceptSelectedUpdated()},items:{handler(){this.updatePreviousAndNextConcepts()},deep:!0}},created(){this.updatePreviousAndNextConcepts=r.debounce(this._updatePreviousAndNextConcepts,300)},methods:{_updatePreviousAndNextConcepts(){if(!this.shown)return;const e=this.items.findIndex(i=>this.$jskos.compareFast(i.concept,this.conceptSelected)),s=(()=>{if(e==-1)return null;if(!this.showChildren){const i=this.items[e-1];return i&&i.concept}return null})();this.$store.commit({type:"selected/setPreviousConcept",isLeft:this.isLeft,concept:s});const t=(()=>{if(e==-1)return null;if(!this.showChildren){const n=this.items[e+1];return n&&n.concept}const i=(n,o=!0)=>{if(n=p(n),!n)return null;if(o&&n.narrower&&n.narrower.length)return n.narrower[0];const a=p(r.first(n.ancestors)||r.first(n.broader));let l=r.get(a,"narrower");if(a||(l=this.items.filter(h=>h.depth==0).map(h=>h.concept)),!l)return null;const c=l[l.findIndex(h=>this.$jskos.compareFast(h,n))+1];return c||(a?i(a,!1):null)};return i(this.selected.concept[this.isLeft])})();this.$store.commit({type:"selected/setNextConcept",isLeft:this.isLeft,concept:t})},children(e){let s=[],t=p(e.concept),i=e.depth+1;if(t&&t.__ISOPEN__&&t.__ISOPEN__[this.isLeft])for(let n of t.narrower||[]){let o={uri:n?n.uri:"loading",concept:n,depth:i,isSelected:this.$jskos.compareFast(this.conceptSelected,n)};s.push(o),s=s.concat(this.children(o))}return s},conceptSelectedUpdated(){if(!this.shown)return;let e=this.conceptSelectedFromStore;if(this.$jskos.compareFast(e,this.currentSelectedConcept)||(this.currentSelectedConcept=e,this.shouldScroll=!0),this.$jskos.isConcept(e))if(!this.showChildren||e.ancestors&&!e.ancestors.includes(null)){let s=!0;for(let t of e.ancestors||[])t=p(t),this.showChildren&&(!t.narrower||t.narrower.includes(null))&&(s=!1);if(s&&this.shouldScroll){if(this.shouldScroll=!1,this.showChildren)for(let t of e.ancestors||[])this.open(t,this.isLeft,!0);this.scrollToInternal({concept:e})}else s||(this.loading=!0)}else this.loading=!0},scrollToInternal({concept:e}={}){if(!e)return;const s=this.$refs.conceptListItems;let t=s&&s.$el;for(;t&&!t.classList.contains("cocoda-vue-tabs-content");)t=t.parentElement;if(!s||!t||t.style.display=="none"){this.$log.warn("ConceptList: Can't scroll because either conceptList or container are undefined.");return}const i=()=>{this.scrollLater=null,this.loading=!1};let n=this.items.findIndex(l=>this.$jskos.compareFast(l.concept,e));if(n===-1){i();return}const o=t.getElementsByClassName("conceptListItems")[0],a=o&&o.querySelectorAll(`.conceptListItem[data-uri="${e.uri}"]`)[0];if(this.checkInView(o,a,!1)){i();return}n=Math.min(n,Math.abs(n-1),Math.abs(n-2)),r.delay(()=>{s.scrollToIndex(n),i()},200)}}},oe={};var vt=d(gt,mt,ft,!1,yt,"111ec35f",null,null);function yt(e){for(let s in oe)this[s]=oe[s]}var _t=function(){return vt.exports}(),wt=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"conceptListWrapper",style:""+(e.concepts.length==0?"min-height: 80px; max-height: 80px;":"")},[t("tabs",{staticStyle:{position:"absolute",top:"0",bottom:"0",left:"0",right:"0"},attrs:{value:e.currentChoiceIndex,fill:""},on:{change:e.tabChanged},scopedSlots:e._u([{key:"title",fn:function(i){return[t("span",[e._v(" "+e._s(i.tab.title)+" ")])]}}])},e._l(e.dataChoices,function(i,n){return t("tab",{key:"conceptListWrapper-dataChoice-"+n,staticStyle:{position:"relative",overflow:"hidden !important"},attrs:{title:i.label,hidden:i!==e.currentChoice},nativeOn:{dragover:function(o){return e.dragOver.apply(null,arguments)},drop:function(o){return e.drop(o,i.droppedConcept)}}},[t("concept-list",{ref:"conceptList",refInFor:!0,attrs:{"is-left":e.isLeft,concepts:i.concepts,"show-children":i.showChildren,"show-scheme":i.showScheme,"no-items-label":i.noItemsLabel,buttons:i.buttons,shown:n==e.currentChoiceIndex},on:{scroll:e.loadConceptsInView}})],1)}),1),e.dataChoices.filter(function(i){return i.available}).length>1?t("div",{staticClass:"button conceptListWrapper-listSelectionButton",attrs:{id:"conceptListWrapper-listSelectionButton-"+e.isLeft}},[t("font-awesome-icon",{attrs:{icon:"chevron-up"}})],1):e._e(),t("component-settings"),t("data-modal-button",{attrs:{data:e.minimizeConcepts(e.currentChoice.concepts),"position-right":20,"position-bottom":0,type:"concept",url:e.currentChoice.url}}),e.dataChoices.filter(function(i){return i.available}).length>1?t("b-popover",{ref:"listSelectionPopover",attrs:{placement:"top",show:e.listSelectionPopoverShow,target:"conceptListWrapper-listSelectionButton-"+e.isLeft},on:{"update:show":function(i){e.listSelectionPopoverShow=i}}},[t("div",{attrs:{id:"conceptListWrapper-listSelectionPopover-"+e.isLeft}},e._l(e.dataChoices,function(i,n){return t("div",{directives:[{name:"show",rawName:"v-show",value:i.available,expression:"choice.available"},{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:i.tooltip,delay:e.defaults.delay.medium,html:!0},expression:"{ title: choice.tooltip, delay: defaults.delay.medium, html: true }",modifiers:{hover:!0}}],key:"conceptListWrapper-listSelectionPopover-"+e.isLeft+"-"+n,class:{"fontWeight-heavy":i===e.currentChoice,"conceptListWrapper-listSelectionPopover-choice":!0},on:{click:function(o){return e.chooseIndex(n)}}},[t("div",{staticClass:"fontSize-small",staticStyle:{display:"inline-block",width:"18px"}},[t("font-awesome-icon",{attrs:{icon:i.icon}})],1),e._v(" "+e._s(i.label)+" ")])}),0)]):e._e(),e.currentChoice.reloadButton?t("div",{staticClass:"dataModalButton fontSize-small conceptListWrapper-reloadButton",on:{click:e.reloadList}},[t("font-awesome-icon",{attrs:{icon:"sync-alt"}})],1):e._e(),e.loading?t("loading-indicator-full"):e._e(),e.concepts.length>0?t("minimizer",{attrs:{name:"conceptList_"+e.isLeft,text:e.currentChoice.label}}):e._e()],1)},St=[];const bt={name:"ConceptListWrapper",components:{Minimizer:R,ConceptList:_t,ComponentSettings:I,DataModalButton:Q,LoadingIndicatorFull:z},mixins:[v,g,M,xe,T],props:{isLeft:{type:Boolean,default:!0}},data(){return{listSelectionPopoverShow:!1,loading:0}},computed:{dataChoices(){let e=r.get(p(this.selected.scheme[this.isLeft]),"_registry.top");e&&(e+=`?uri=${encodeURIComponent(this.selected.scheme[this.isLeft].uri)}`);let s=[{id:"topConcepts",label:this.$t("conceptList.topConceptsShort"),tooltip:this.$t("conceptList.topConcepts"),noItemsLabel:this.$t("schemeDetail.noTopConcepts"),concepts:this._topConcepts,showChildren:!0,showScheme:!1,url:e,available:this._topConcepts.length>0,icon:"sitemap"},{id:"favoriteConcepts",label:this.$t("conceptList.favoriteConceptsShort"),tooltip:this.$t("conceptList.favoriteConcepts"),concepts:this.favoriteConcepts,showChildren:!1,showScheme:!0,available:!0,buttons:[{position:"before",icon:"times-circle",tooltip:this.$t("schemeSelection.starRemove"),onClick:(i,n)=>{this.$store.dispatch("removeConceptFromFavorites",n)}}],droppedConcept:i=>{this.$store.dispatch("addConceptToFavorites",i)},icon:"star"}],t=0;for(let i of this.config.conceptLists||[]){if(i.schemes&&!i.schemes.find(c=>this.$jskos.compare(c,this.selected.scheme[this.isLeft]))){t+=1;continue}let n=this.$jskos.notation(i),o=this.$jskos.prefLabel(i),a="";n&&(o&&(a=`<b>${o}</b><br>`),o=n),a+=this.$jskos.languageMapContent(i,"scopeNote")||"";let l={id:`custom-${t}`,label:o,tooltip:a,concepts:i.concepts,showChildren:!1,showScheme:!0,url:i.url||i.conceptsUrl,available:i.concepts.length>0,icon:"list"};l.reloadButton=l.url!=null,s.push(l),t+=1}return s},_topConcepts(){let e=r.get(this.selected.scheme[this.isLeft],"uri",null);return r.get(J(e),"topConcepts")||[]},concepts(){return this.currentChoice.concepts},currentChoice:{get(){let e=this.$settings.conceptListChoice[this.isLeft];return this.dataChoices.find(s=>s.id===e&&s.available)||this.dataChoices.find(s=>s.available)},set(e){this.$store.commit({type:"settings/set",prop:`conceptListChoice[${this.isLeft}]`,value:e.id})}},currentChoiceIndex:{get(){return this.dataChoices.findIndex(e=>e===this.currentChoice)},set(e){this.currentChoice=this.dataChoices[e]}}},created(){this.loadConceptsInView=r.debounce(this._loadConceptsInView,300)},methods:{chooseIndex(e){this.currentChoiceIndex=e,this.listSelectionPopoverShow=!1},tabChanged(){this.loadConceptsInView()},droppedConcept(e,s){s&&s(e)},_loadConceptsInView(){const e=[],s=r.get(this,`$refs.conceptList[${this.currentChoiceIndex}]`),t=r.get(s,"$children[0].$children"),i=r.get(s,"$children[0].$el");if(t&&i)for(let n of t){if(!n||!n.$el)continue;const o=n.$el,a=r.get(n,"$children[0].concept");a&&this.checkInView(i,o)&&e.push(a)}e.forEach(n=>L(n,{type:"concept",returnIfExists:!0})),$(e),this.loadMappingsForConcepts(e,this.isLeft)},minimizeConcepts(e){let s=[];for(let t of e){if(!t)continue;let i={uri:t.uri,notation:t.notation};t.inScheme&&t.inScheme[0]&&t.inScheme[0].uri&&(i.inScheme=[{uri:t.inScheme[0].uri}]),s.push(i)}return s},hoverHandlers(){return[{elements:[document.getElementById(`conceptListWrapper-listSelectionButton-${this.isLeft}`),document.getElementById(`conceptListWrapper-listSelectionPopover-${this.isLeft}`)],delta:5,handler:e=>{this.listSelectionPopoverShow=e}}]},async reloadList(){this.loading+=1;let e=await this.$store.dispatch("loadConceptLists");this.$store.commit({type:"setConfig",option:"conceptLists",value:e}),this.loading-=1}}},re={};var Ct=d(bt,wt,St,!1,$t,null,null,null);function $t(e){for(let s in re)this[s]=re[s]}var kt=function(){return Ct.exports}(),Lt=function(){var e=this,s=e.$createElement,t=e._self._c||s;return e.narrower&&e.narrower.length>0?t("div",{staticClass:"itemDetailNarrower"},[e.text!=null?t("div",{staticClass:"fontWeight-heavy"},[e._v(" "+e._s(e.text)+" ")]):e._e(),e._l(e.narrower.filter(function(i){return i!=null}),function(i){return t("div",{key:i.uri,staticClass:"itemDetailNarrower-item",class:{"concept-mappingsExist":e.loadConceptsMappedStatus&&e.$store.getters.mappedStatus(i,e.isLeft),"concept-mappingsDoNotExist":e.loadConceptsMappedStatus&&!e.$store.getters.mappedStatus(i,e.isLeft)}},[t("font-awesome-icon",{staticClass:"u-flip-horizontal",attrs:{icon:"level-down-alt"}}),t("item-name",{attrs:{item:i,"is-link":!0,"is-left":e.isLeft,"font-size":"small"}})],1)}),e.narrower.length!=0&&e.narrower.includes(null)?t("loading-indicator",{attrs:{size:"sm"}}):e._e()],2):e._e()},xt=[];const Mt={name:"ItemDetailNarrower",components:{ItemName:C,LoadingIndicator:D},mixins:[T],props:{narrower:{type:Array,default:()=>new Array},text:{type:String,default:null},isLeft:{type:Boolean,default:!0}},computed:{loadConceptsMappedStatusConceptsToLoad(){return this.narrower.filter(e=>e)}}},ae={};var Ft=d(Mt,Lt,xt,!1,jt,"713644cc",null,null);function jt(e){for(let s in ae)this[s]=ae[s]}var le=function(){return Ft.exports}(),It=function(){var e=this,s=e.$createElement,t=e._self._c||s;return e.item!=null?t("div",{staticClass:"conceptDetail"},[t("div",{staticClass:"conceptDetail-ancestors"},[e.ancestors.length>3&&!e.settings.showAllAncestors?t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.showAncestors?e.$t("conceptDetail.showLessAncestors"):e.$t("conceptDetail.showAllAncestors"),delay:e.defaults.delay.medium},expression:"{ title: showAncestors ? $t('conceptDetail.showLessAncestors') : $t('conceptDetail.showAllAncestors'), delay: defaults.delay.medium }",modifiers:{hover:!0}}],staticClass:"button conceptDetail-ancestors-expand",on:{click:function(i){e.showAncestors=!e.showAncestors}}},[t("font-awesome-icon",{attrs:{icon:e.showAncestors?"angle-down":"angle-right"}})],1):e._e(),e._l(e.ancestors.filter(function(i){return i!=null}).reverse(),function(i,n){return t("div",{key:"conceptDetail-"+e.isLeft+"-ancesters-"+i.uri+"-"+n,class:{"concept-mappingsExist":(e.showAncestors||e.settings.showAllAncestors||n==0||n==e.ancestors.length-1||e.ancestors.length<=3)&&e.loadConceptsMappedStatus&&e.$store.getters.mappedStatus(i,e.isLeft),"concept-mappingsDoNotExist":e.loadConceptsMappedStatus&&!e.$store.getters.mappedStatus(i,e.isLeft)}},[e.showAncestors||e.settings.showAllAncestors||n==0||n==e.ancestors.length-1||e.ancestors.length<=3?t("span",[t("font-awesome-icon",{staticClass:"u-flip-horizontal",attrs:{icon:"level-up-alt"}}),t("item-name",{attrs:{item:i,"is-link":!0,"is-left":e.isLeft,"font-size":"small"}})],1):n==1?t("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.$t("conceptDetail.showAllAncestors"),delay:e.defaults.delay.medium},expression:"{ title: $t('conceptDetail.showAllAncestors'), delay: defaults.delay.medium }",modifiers:{hover:!0}}],staticClass:"conceptDetail-ancestors-more button",on:{click:function(o){e.showAncestors=!0}}},[t("font-awesome-icon",{staticClass:"u-flip-horizontal",attrs:{icon:"ellipsis-v"}})],1):e._e()])}),e._l((e.ancestors.length==0&&e.item.__BROADERLOADED__?e.broader:[]).filter(function(i){return i!=null}),function(i,n){return t("div",{key:"conceptDetail-"+e.isLeft+"-broader-"+i.uri+"-"+n,class:{"concept-mappingsExist":e.loadConceptsMappedStatus&&e.$store.getters.mappedStatus(i,e.isLeft),"concept-mappingsDoNotExist":e.loadConceptsMappedStatus&&!e.$store.getters.mappedStatus(i,e.isLeft)}},[t("font-awesome-icon",{attrs:{icon:"sort-up"}}),t("item-name",{attrs:{item:i,"is-link":!0,"is-left":e.isLeft,"font-size":"small"}})],1)}),e.ancestors.length!=0&&e.ancestors.includes(null)||e.ancestors.length==0&&e.broader.length!=0&&!e.item.__BROADERLOADED__?t("loading-indicator",{attrs:{size:"sm"}}):e._e()],2),t("div",{staticClass:"conceptDetail-name",class:{"concept-mappingsExist":e.loadConceptsMappedStatus&&e.$store.getters.mappedStatus(e.item,e.isLeft),"concept-mappingsDoNotExist":e.loadConceptsMappedStatus&&!e.$store.getters.mappedStatus(e.item,e.isLeft)}},[t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.$t("conceptDetail.clearConcept"),delay:e.defaults.delay.medium},expression:"{ title: $t('conceptDetail.clearConcept'), delay: defaults.delay.medium }",modifiers:{hover:!0}}],staticClass:"button conceptDetail-name-clearButton",on:{click:function(i){return e.setSelected({scheme:e.selected.scheme[e.isLeft],isLeft:e.isLeft})}}},[t("font-awesome-icon",{attrs:{icon:"times-circle"}})],1),t("item-name",{attrs:{item:e.item,"is-highlighted":!0,"font-size":"normal"}}),t("font-awesome-icon",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.$jskos.isContainedIn(e.item,e.favoriteConcepts)?e.$t("schemeSelection.starRemove"):e.$t("schemeSelection.starAdd"),delay:e.defaults.delay.medium},expression:"{ title: $jskos.isContainedIn(item, favoriteConcepts) ? $t('schemeSelection.starRemove') : $t('schemeSelection.starAdd'), delay: defaults.delay.medium }",modifiers:{hover:!0}}],staticClass:"pointer fontSize-verySmall",class:e.$jskos.isContainedIn(e.item,e.favoriteConcepts)?"starFavorite":"starNormal",attrs:{icon:"star"},on:{click:function(i){e.$jskos.isContainedIn(e.item,e.favoriteConcepts)?e.$store.dispatch("removeConceptFromFavorites",e.item):e.$store.dispatch("addConceptToFavorites",e.item)}}}),e.showAddToMappingButton?t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.$t("general.addToMapping"),delay:e.defaults.delay.medium},expression:"{ title: $t('general.addToMapping'), delay: defaults.delay.medium }",modifiers:{hover:!0}}],staticClass:"conceptDetail-name-addButton",class:{button:e.showAddToMappingButton},on:{click:function(i){e.addToMapping({concept:e.item,scheme:e.item.inScheme&&e.item.inScheme[0]||e.selected.scheme[e.isLeft],isLeft:e.isLeft})}}},[t("font-awesome-icon",{attrs:{icon:"plus-circle"}})],1):e._e()],1),t("tabs",{ref:"tabs",staticStyle:{"margin-top":"3px",position:"relative"},attrs:{borders:"bottom",size:"sm"}},[e.previousConcept?t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.$t("conceptDetail.previousConceptTooltip"),delay:e.defaults.delay.medium},expression:"{ title: $t('conceptDetail.previousConceptTooltip'), delay: defaults.delay.medium }",modifiers:{hover:!0}}],staticClass:"conceptDetail-previousButton"},[t("router-link",{attrs:{to:e.getRouterUrl(e.previousConcept,e.isLeft,!0)}},[t("b-button",{staticClass:"button",attrs:{variant:"light"}},[t("font-awesome-icon",{attrs:{icon:"arrow-left"}})],1)],1)],1):e._e(),e.nextConcept?t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.$t("conceptDetail.nextConceptTooltip"),delay:e.defaults.delay.medium},expression:"{ title: $t('conceptDetail.nextConceptTooltip'), delay: defaults.delay.medium }",modifiers:{hover:!0}}],staticClass:"conceptDetail-nextButton"},[t("router-link",{attrs:{to:e.getRouterUrl(e.nextConcept,e.isLeft,!0)}},[t("b-button",{staticClass:"button",attrs:{variant:"light"}},[t("font-awesome-icon",{attrs:{icon:"arrow-right"}})],1)],1)],1):e._e(),t("tab",{attrs:{title:e.$t("conceptDetail.info")}},[e._l([e.item.uri].concat(e.item.identifier).filter(function(i){return i!=null}),function(i,n){return t("div",{key:"conceptDetail-"+e.isLeft+"-identifier-"+n,class:(i.startsWith("http"),"conceptDetail-identifier")},[t("font-awesome-icon",{attrs:{icon:i.startsWith("http")?"link":"id-card"},on:{dblclick:function(o){e.copyToClipboard(e.elementForEvent(o))}}}),t("auto-link",{attrs:{link:i}})],1)}),e._l(e.types,function(i){return t("div",{key:"conceptDetail-"+e.isLeft+"-type-"+i.uri,staticClass:"conceptDetail-identifier"},[t("b",[e._v(e._s(e.$t("general.type"))+":")]),e._v(" "+e._s(e.$jskos.prefLabel(i,{language:e.locale}))+" ")])}),e.item.creator&&e.item.creator.length?t("div",{staticClass:"conceptDetail-identifier"},[t("font-awesome-icon",{attrs:{icon:"user"}}),e._v(" "+e._s(e.$jskos.prefLabel(e.item.creator[0]))+" ")],1):e._e(),t("div",{staticClass:"conceptDetail-identifier"},[e.item.created?t("span",[t("b",[e._v(e._s(e.$t("conceptDetail.created"))+":")]),e._v(" "),t("date-string",{attrs:{date:e.item.created}})],1):e._e(),e.item.issued?t("span",[t("b",[e._v(e._s(e.$t("conceptDetail.issued"))+":")]),e._v(" "),t("date-string",{attrs:{date:e.item.issued}})],1):e._e(),e.item.modified?t("span",[t("b",[e._v(e._s(e.$t("conceptDetail.modified"))+":")]),e._v(" "),t("date-string",{attrs:{date:e.item.modified}})],1):e._e()]),e.item.definition?e._l([e.$jskos.languagePreference.selectLanguage(e.item.definition)].concat(Object.keys(e.item.definition).filter(function(i){return i!=e.$jskos.languagePreference.selectLanguage(e.item.definition)&&i!="-"})),function(i){return t("div",{key:"conceptDetail-"+e.isLeft+"-defintion-"+i,staticClass:"conceptDetail-identifier"},[t("b",[e._v(e._s(e.$t("conceptDetail.definition"))+":")]),e._v(" "+e._s(e.$jskos.definition(e.item,{language:i}).join(", "))+" "),t("sup",{staticClass:"text-lightGrey"},[e._v(e._s(i))])])}):e._e()],2),t("tab",{attrs:{title:e.$t("conceptDetail.labels")}},[e._l([e.$jskos.languagePreference.selectLanguage(e.item.prefLabel)].concat(Object.keys(e.item.prefLabel||{}).filter(function(i){return i!=e.$jskos.languagePreference.selectLanguage(e.item.prefLabel)})).filter(function(i){return i&&i!="-"}),function(i){return t("div",{key:"conceptDetail-"+e.isLeft+"-prefLabel-"+i,staticClass:"conceptDetail-identifier"},[t("span",{staticClass:"fontWeight-medium",on:{click:function(n){e.copyAndSearch(e.$jskos.prefLabel(e.item,{language:i}))}}},[e._v(" "+e._s(e.$jskos.prefLabel(e.item,{language:i}))+" ")]),t("sup",{staticClass:"text-lightGrey"},[e._v(e._s(i))])])}),e.$jskos.languageMapContent(e.item,"altLabel")?t("div",{staticClass:"fontWeight-heavy",staticStyle:{"margin-top":"10px"}},[e._v(" "+e._s(e.$t("conceptDetail.altLabels"))+": ")]):e._e(),e._l(Object.keys(e.item.altLabel||{}).map(function(i){return e.item.altLabel[i].map(function(n){return{language:i,label:n}})}).reduce(function(i,n){return i.concat(n)},[]).filter(function(i){return i.language!="-"}).sort(function(i,n){return i.language==e.$jskos.languagePreference.selectLanguage(e.item.altLabel)?-1:n.language==e.$jskos.languagePreference.selectLanguage(e.item.altLabel)?1:0}),function(i,n){var o=i.language,a=i.label;return t("div",{key:"conceptDetail-"+e.isLeft+"-altLabel-"+o+"-"+n,staticClass:"conceptDetail-identifier"},[t("span",{on:{click:function(l){return e.copyAndSearch(a)}}},[e._v(" "+e._s(a)+" ")]),t("sup",{staticClass:"text-lightGrey"},[e._v(e._s(o))])])})],2),e._l([[{de:e.gndTerms},e.$t("conceptDetail.gnd")],[e.item.scopeNote,e.$t("conceptDetail.scope")],[e.item.editorialNote,e.$t("conceptDetail.editorial")]].filter(function(i){return Object.values(i[0]||{}).reduce(function(n,o){return n+o.length},0)>0}),function(i,n){var o=i[0],a=i[1];return[t("tab",{key:"conceptDetail-"+e.isLeft+"-notes-"+n,staticClass:"conceptDetail-notes",attrs:{title:a,hidden:o==""}},e._l(Object.keys(o||{}).map(function(l){return o[l].map(function(c){return{language:l,note:c}})}).reduce(function(l,c){return l.concat(c)},[]).filter(function(l){return l.language!="-"}).sort(function(l,c){return l.language==e.$jskos.languagePreference.selectLanguage(o)?-1:c.language==e.$jskos.languagePreference.selectLanguage(o)?1:0}),function(l,c){var h=l.language,m=l.note;return t("div",{key:"conceptDetail-"+e.isLeft+"-notes-"+h+"-"+c,staticClass:"conceptDetail-note"},[t("span",{domProps:{innerHTML:e._s(m)}}),t("sup",{staticClass:"text-lightGrey"},[e._v(" "+e._s(h))])])}),0)]}),e.memberList&&e.memberList.length?t("tab",{attrs:{title:"coli-ana"}},[t("ul",{staticClass:"coli-ana"},[t("li",[t("div"),t("div",[e._v(e._s(e.$jskos.notation(e.item)))]),t("div")]),e._l(e.memberList,function(i,n){return t("li",{key:i.uri+"-"+n,class:{"font-weight-bold":e.memberList[n-1]&&e.isMemberParentOf(e.memberList[n-1],i)&&!e.isMemberParentOf(i,e.memberList[n+1])}},[t("div",[e.isMemberParentOf(e.memberList[n-1],i)?t("span",[e._v(" \u21B3 ")]):e._e()]),t("div",[e._v(e._s(i.notation[1]))]),t("div",[t("item-name",{attrs:{item:i,"show-notation":!1,"is-link":!0,"is-left":e.isLeft,"font-size":"small"}}),i.uri.includes("facet")?e._e():t("span",[e._v(" ("),t("item-name",{attrs:{item:i,"show-text":!1,"is-link":!1,"font-size":"small"}}),e._v(") ")],1)],1)])})],2),e.memberListComplete?e._e():t("p",{domProps:{innerHTML:e._s(e.$t("conceptDetail.coliAnaIncomplete"))}}),t("p",{domProps:{innerHTML:e._s(e.$t("conceptDetail.coliAnaInfo",{url:e.config["coli-ana"]+"?notation="+e.$jskos.notation(e.item)}))}})]):e._e(),e.searchLinks.length?t("tab",{key:"conceptDetail-"+e.isLeft+"-searchLinks",attrs:{title:e.$t("conceptDetail.searchLinks")}},[t("ul",{staticStyle:{"margin-bottom":"0"}},e._l(e.searchLinks,function(i,n){return t("li",{key:"searchLink-"+e.isLeft+"-"+n},[t("a",{attrs:{href:i.url,target:"_blank"}},[e._v(" "+e._s(i.label)+" ")])])}),0)]):e._e()],2),t("item-detail-narrower",{attrs:{narrower:e.item.narrower,"is-left":e.isLeft}})],1):e._e()},Dt=[];const Et={name:"ConceptDetail",components:{AutoLink:X,ItemName:C,LoadingIndicator:D,ItemDetailNarrower:le,DateString:Y},mixins:[g,v,B,T],props:{item:{type:Object,default:null},isLeft:{type:Boolean,default:!0},settings:{type:Object,default:()=>({})}},data(){return{showAncestors:!1,searchLinks:[]}},computed:{_item(){return p(this.item)},memberList(){return this._item&&this._item.memberList&&this._item.memberList.filter(Boolean)},memberListComplete(){return this._item&&this._item.memberList&&!this._item.memberList.includes(null)},showAddToMappingButton(){return this.$store.getters["mapping/canAdd"](this._item,r.get(this._item,"inScheme[0]")||this.selected.scheme[this.isLeft],this.isLeft)},ancestors(){return E(r.get(this.item,"ancestors",[])||[])},broader(){return E(r.get(this.item,"broader",[])||[])},searchLinkInfo(){return{uri:this._item&&this._item.uri,language:this.locale,notation:this.$jskos.notation(this._item),prefLabel:this.$jskos.prefLabel(this._item,{fallbackToUri:!1})}},types(){if(!this._item||(this._item.type||[]).length<=1)return[];let e=[];const t=p(r.get(this.item,"inScheme[0]")).types||[];for(let i of this._item.type||[]){if(i=="http://www.w3.org/2004/02/skos/core#Concept")continue;let n={uri:i};n=t.find(o=>this.$jskos.compare(o,n))||n,e.push(n)}return e},gndTerms(){let e=p({uri:"http://bartoc.org/en/node/430"}),s=r.get(this._item,"__GNDMAPPINGS__",[]),t=[];for(let o of s)for(let a of this.$jskos.conceptsOfMapping(o))this.$jskos.compare(e,r.get(a,"inScheme[0]"))&&!t.find(l=>this.$jskos.compare(l.concept,a))&&t.push({concept:p(a),type:this.$jskos.mappingTypeByType(o.type)});let i=[],n=["conceptDetail.relevanceVeryHigh","conceptDetail.relevanceHigh","conceptDetail.relevanceMedium","conceptDetail.relevanceLow","conceptDetail.relevanceGeneric"];for(let o of n){let a=`<strong>${this.$t("conceptDetail.relevance")}: ${this.$t(o)}</strong> - `,l=[];for(let{concept:c}of t.filter(h=>h.type.RELEVANCE==this.$t(o,"en")))c&&this.$jskos.prefLabel(c,{fallbackToUri:!1})&&l.push(r.escape(this.$jskos.prefLabel(c)));l.length>0&&(a=a+l.join(", "),i.push(a))}return i},previousConcept(){return this.selected.previousConcept[this.isLeft]},nextConcept(){return this.selected.nextConcept[this.isLeft]},loadConceptsMappedStatusConceptsToLoad(){return this.item?[this.item].concat(this.item.ancestors||[],this.item.broader||[]).filter(e=>e!=null):[]}},watch:{_item(e,s){this.$jskos.compare(e,s)||this.refresh()},settings(e,s){r.isEqual(e,s)||this.refresh()},searchLinkInfo(e,s){r.isEqual(e,s)||this.updateSearchLinks(e)}},mounted(){this.refresh(),this.updateSearchLinks(this.searchLinkInfo),this.enableShortcuts()},methods:{shortcutHandler({action:e,isLeft:s}){e=="nextConcept"&&s==this.isLeft&&this.nextConcept&&this.setSelected({concept:this.nextConcept,isLeft:s})},refresh(){this.showAncestors=!1,this.loadGndTerms(),$([this.item],{force:!0}),this.loadColiAna()},async loadGndTerms(){if(!this.item)return;let e=this._item,s=p({uri:"http://bartoc.org/en/node/430"});if(this.$jskos.compare(s,r.get(e,"inScheme[0]")))return;const t=this.config.registries.filter(o=>o.has.mappings&&this.$jskos.mappingRegistryIsStored(o)).map(o=>this.getMappings({registry:o,direction:"both",from:e,toScheme:s.uri}).catch(()=>[]));let i=r.flatten(await Promise.all(t)),n=[];for(let o of i){let a=this.$jskos.conceptsOfMapping(o);for(let l of a)this.$jskos.compare(s,r.get(l,"inScheme[0]"))&&n.push(l)}n=r.uniqWith(n,this.$jskos.compare),await $(n),A(e,"__GNDMAPPINGS__",i)},async loadColiAna(){const e=this.config["coli-ana"];if(!e)return;const s=p(this._item,{relatedItems:!0});if(!s||s.memberList)return;const t=p({uri:"http://dewey.info/scheme/edition/e23/"});if(!this.$jskos.compare(t,r.get(s,"inScheme[0]")))return;const n=((await Oe.get(`${e}analyze`,{params:{notation:this.$jskos.notation(s)}})).data||[]).find(o=>this.$jskos.compare(o,s));n&&(n.memberList.forEach(o=>{o&&L(r.omit(o,["notation"]),{scheme:t,type:"concept"})}),A(s,"memberList",n.memberList),$(n.memberList.filter(Boolean)),this.$nextTick(()=>{const o=this.$refs.tabs,a=o.tabs.findIndex(l=>l.title==="coli-ana");s.__DETAILSLOADED__===-1&&a!==-1&&o.activateTab(a)}))},isMemberParentOf(e,s){return e=p(e),s=p(s),!e||!s||!s.broader||!s.broader.length?!1:this.$jskos.compare(e,s.broader[0])},elementForEvent(e){let s=e.target;return s.tagName.toLowerCase()=="path"&&(s=s.parentElement),s=s.nextElementSibling,s},hasNotes(e){let s=["scopeNote","editorialNote","altLabel"],t=!1;for(let i of s)t=t||this.$jskos.languageMapContent(e,i)&&this.$jskos.languageMapContent(e,i).length;return t},copyAndSearch(e){this.$emit("searchConcept",e)},async updateSearchLinks(e){this.searchLinks=await this.$store.dispatch("getSearchLinks",G({scheme:p(this.selected.scheme[this.isLeft])},e))}}},ce={};var zt=d(Et,It,Dt,!1,Tt,"21a9676a",null,null);function Tt(e){for(let s in ce)this[s]=ce[s]}var At=function(){return zt.exports}(),Bt=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.html.right",value:e.tooltip?e.tooltipHtml:"",expression:"tooltip ? tooltipHtml : ''",modifiers:{html:!0,right:!0}}],domProps:{innerHTML:e._s(e.registryName)}})},Rt=[];const Nt={name:"RegistryName",mixins:[v],props:{registry:{type:Object,default:null},tooltip:{type:Boolean,default:!0}},computed:{registryName:function(){let e=this.$jskos.prefLabel(this.registry,{language:this.locale}),s=this.$jskos.notation(this.registry);return e?e.replace(s,function(){return"<b>"+s+"</b>"}):(s=0,s||"?")},tooltipHtml(){return this.$jskos.definition(this.registry,{language:this.locale}).join("<br>")}}},pe={};var Ot=d(Nt,Bt,Rt,!1,Pt,null,null,null);function Pt(e){for(let s in pe)this[s]=pe[s]}var Ht=function(){return Ot.exports}(),he=[{uri:"http://w3id.org/nkos/nkostype#gazetteer",type:["http://www.w3.org/2004/02/skos/core#Concept"],"@context":"http://gbv.github.io/jskos/context.json",inScheme:[{uri:"http://w3id.org/nkos/nkostype",prefLabel:{de:"KOS Typ Vokabular"},type:["http://www.w3.org/2004/02/skos/core#ConceptScheme","http://w3id.org/nkos/nkostype#list"]}],publisher:[{prefLabel:{de:"DCMI/NKOS Task Group"}}],notation:["gazetteer"],prefLabel:{en:"Gazetteer",de:"Gazetteer"},altLabel:{de:["Ortsverzeichnis","Ortslexikon"]},scopeNote:{en:["geospatial dictionary of named and typed places"]},narrower:[]},{uri:"http://w3id.org/nkos/nkostype#glossary",type:["http://www.w3.org/2004/02/skos/core#Concept"],"@context":"http://gbv.github.io/jskos/context.json",inScheme:[{uri:"http://w3id.org/nkos/nkostype",prefLabel:{de:"KOS Typ Vokabular"},type:["http://www.w3.org/2004/02/skos/core#ConceptScheme","http://w3id.org/nkos/nkostype#list"]}],publisher:[{prefLabel:{de:"DCMI/NKOS Task Group"}}],notation:["glossary"],prefLabel:{en:"Glossary",de:"Glossar"},scopeNote:{en:["a collection of textual glosses or of specialized terms with their meanings"]},narrower:[]},{uri:"http://w3id.org/nkos/nkostype#categorization_schema",type:["http://www.w3.org/2004/02/skos/core#Concept"],"@context":"http://gbv.github.io/jskos/context.json",inScheme:[{uri:"http://w3id.org/nkos/nkostype",prefLabel:{de:"KOS Typ Vokabular"},type:["http://www.w3.org/2004/02/skos/core#ConceptScheme","http://w3id.org/nkos/nkostype#list"]}],publisher:[{prefLabel:{de:"DCMI/NKOS Task Group"}}],notation:["categorization_schema"],prefLabel:{en:"Categorization schema",de:"Kategorienschema"},scopeNote:{en:["schedule of concepts and pre-coordinated combinations of concepts, arranged by classification"]},narrower:[]},{uri:"http://w3id.org/nkos/nkostype#classification_schema",type:["http://www.w3.org/2004/02/skos/core#Concept"],"@context":"http://gbv.github.io/jskos/context.json",inScheme:[{uri:"http://w3id.org/nkos/nkostype",prefLabel:{de:"KOS Typ Vokabular"},type:["http://www.w3.org/2004/02/skos/core#ConceptScheme","http://w3id.org/nkos/nkostype#list"]}],publisher:[{prefLabel:{de:"DCMI/NKOS Task Group"}}],notation:["classification_schema"],prefLabel:{en:"Classification schema",de:"Klassifikation"},narrower:[]},{uri:"http://w3id.org/nkos/nkostype#list",type:["http://www.w3.org/2004/02/skos/core#Concept"],"@context":"http://gbv.github.io/jskos/context.json",inScheme:[{uri:"http://w3id.org/nkos/nkostype",prefLabel:{de:"KOS Typ Vokabular"},type:["http://www.w3.org/2004/02/skos/core#ConceptScheme","http://w3id.org/nkos/nkostype#list"]}],publisher:[{prefLabel:{de:"DCMI/NKOS Task Group"}}],notation:["list"],prefLabel:{en:"List",de:"Liste"},scopeNote:{en:["a limited set of terms arranged as a simple alphabetical list or in some other logically evident way; containing no relationships of any kind"]},narrower:[]},{uri:"http://w3id.org/nkos/nkostype#name_authority_list",type:["http://www.w3.org/2004/02/skos/core#Concept"],"@context":"http://gbv.github.io/jskos/context.json",inScheme:[{uri:"http://w3id.org/nkos/nkostype",prefLabel:{de:"KOS Typ Vokabular"},type:["http://www.w3.org/2004/02/skos/core#ConceptScheme","http://w3id.org/nkos/nkostype#list"]}],publisher:[{prefLabel:{de:"DCMI/NKOS Task Group"}}],notation:["name_authority_list"],prefLabel:{en:"Name authority list",de:"Namensdatei"},scopeNote:{en:["controlled vocabulary for use in naming particular entities consistently"]},narrower:[]},{uri:"http://w3id.org/nkos/nkostype#ontology",type:["http://www.w3.org/2004/02/skos/core#Concept"],"@context":"http://gbv.github.io/jskos/context.json",inScheme:[{uri:"http://w3id.org/nkos/nkostype",prefLabel:{de:"KOS Typ Vokabular"},type:["http://www.w3.org/2004/02/skos/core#ConceptScheme","http://w3id.org/nkos/nkostype#list"]}],publisher:[{prefLabel:{de:"DCMI/NKOS Task Group"}}],notation:["ontology"],prefLabel:{en:"Ontology",de:"Ontologie"},scopeNote:{en:["A formal model that allows knowledge to be represented for a specific domain. An ontology describes the types of things that exist (classes), the relationships between them (properties) and the logical ways those classes and properties can be used together (axioms)"]},narrower:[]},{uri:"http://w3id.org/nkos/nkostype#subject_heading_scheme",type:["http://www.w3.org/2004/02/skos/core#Concept"],"@context":"http://gbv.github.io/jskos/context.json",inScheme:[{uri:"http://w3id.org/nkos/nkostype",prefLabel:{de:"KOS Typ Vokabular"},type:["http://www.w3.org/2004/02/skos/core#ConceptScheme","http://w3id.org/nkos/nkostype#list"]}],publisher:[{prefLabel:{de:"DCMI/NKOS Task Group"}}],notation:["subject_heading_scheme"],prefLabel:{en:"Subject heading scheme",de:"Schlagwortliste"},scopeNote:{en:["structured vocabulary comprising terms available for subject indexing, plus rules for combining them into pre-coordinated strings of terms where necessary"]},narrower:[]},{uri:"http://w3id.org/nkos/nkostype#semantic_network",type:["http://www.w3.org/2004/02/skos/core#Concept"],"@context":"http://gbv.github.io/jskos/context.json",inScheme:[{uri:"http://w3id.org/nkos/nkostype",prefLabel:{de:"KOS Typ Vokabular"},type:["http://www.w3.org/2004/02/skos/core#ConceptScheme","http://w3id.org/nkos/nkostype#list"]}],publisher:[{prefLabel:{de:"DCMI/NKOS Task Group"}}],notation:["semantic_network"],prefLabel:{en:"Semantic network",de:"Semantisches Netz"},scopeNote:{en:["set of terms representing concepts, modeled as the nodes in a network of variable relationship types"]},narrower:[]},{uri:"http://w3id.org/nkos/nkostype#synonym_ring",type:["http://www.w3.org/2004/02/skos/core#Concept"],"@context":"http://gbv.github.io/jskos/context.json",inScheme:[{uri:"http://w3id.org/nkos/nkostype",prefLabel:{de:"KOS Typ Vokabular"},type:["http://www.w3.org/2004/02/skos/core#ConceptScheme","http://w3id.org/nkos/nkostype#list"]}],publisher:[{prefLabel:{de:"DCMI/NKOS Task Group"}}],notation:["synonym_ring"],prefLabel:{en:"Synonym ring",de:"Synset"},scopeNote:{en:["set of synonymous or almost synonymous terms, any of which can be used to refer to a particular concept"]},narrower:[]},{uri:"http://w3id.org/nkos/nkostype#taxonomy",type:["http://www.w3.org/2004/02/skos/core#Concept"],"@context":"http://gbv.github.io/jskos/context.json",inScheme:[{uri:"http://w3id.org/nkos/nkostype",prefLabel:{de:"KOS Typ Vokabular"},type:["http://www.w3.org/2004/02/skos/core#ConceptScheme","http://w3id.org/nkos/nkostype#list"]}],publisher:[{prefLabel:{de:"DCMI/NKOS Task Group"}}],notation:["taxonomy"],prefLabel:{en:"Taxonomy",de:"Taxonomie"},scopeNote:{en:["scheme of categories and subcategories that can be used to sort and otherwise organize items of knowledge or information"]},narrower:[]},{uri:"http://w3id.org/nkos/nkostype#terminology",type:["http://www.w3.org/2004/02/skos/core#Concept"],"@context":"http://gbv.github.io/jskos/context.json",inScheme:[{uri:"http://w3id.org/nkos/nkostype",prefLabel:{de:"KOS Typ Vokabular"},type:["http://www.w3.org/2004/02/skos/core#ConceptScheme","http://w3id.org/nkos/nkostype#list"]}],publisher:[{prefLabel:{de:"DCMI/NKOS Task Group"}}],notation:["terminology"],prefLabel:{en:"Terminology",de:"Terminologie"},scopeNote:{en:["set of designations belonging to one special language [ISO 1087-1:2000, definition 3.5.1]"]},narrower:[]},{uri:"http://w3id.org/nkos/nkostype#thesaurus",type:["http://www.w3.org/2004/02/skos/core#Concept"],"@context":"http://gbv.github.io/jskos/context.json",inScheme:[{uri:"http://w3id.org/nkos/nkostype",prefLabel:{de:"KOS Typ Vokabular"},type:["http://www.w3.org/2004/02/skos/core#ConceptScheme","http://w3id.org/nkos/nkostype#list"]}],publisher:[{prefLabel:{de:"DCMI/NKOS Task Group"}}],notation:["thesaurus"],prefLabel:{en:"Thesaurus",de:"Thesaurus"},scopeNote:{en:["controlled and structured vocabulary in which concepts are represented by terms, organized so that relationships between concepts are made explicit, and preferred terms are accompanied by lead-in entries for synonyms or quasi-synonyms"]},narrower:[]},{uri:"http://w3id.org/nkos/nkostype#dictionary",type:["http://www.w3.org/2004/02/skos/core#Concept"],"@context":"http://gbv.github.io/jskos/context.json",inScheme:[{uri:"http://w3id.org/nkos/nkostype",prefLabel:{de:"KOS Typ Vokabular"},type:["http://www.w3.org/2004/02/skos/core#ConceptScheme","http://w3id.org/nkos/nkostype#list"]}],publisher:[{prefLabel:{de:"DCMI/NKOS Task Group"}}],notation:["dictionary"],prefLabel:{en:"Dictionary",de:"W\xF6rterbuch"},scopeNote:{en:["a reference source containing words usually alphabetically arranged along with information about their forms, pronunciations, functions, etymologies, meanings, and syntactical and idiomatic uses"]},narrower:[]}],Wt=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"schemeDetail"},[t("item-name",{attrs:{item:e._item,"is-highlighted":!0,"font-size":"normal"}}),e._item.license||e.licenseAttribution(e._item)?t("div",{staticClass:"schemeDetail-license"},[e._l(e._item.license,function(i,n){return t("span",{key:"schemeDetail-"+e.isLeft+"-license-"+n},[t("a",{attrs:{href:i.uri,target:"_blank"}},[e.defaults.licenseBadges[i.uri]?t("img",{staticClass:"schemeDetail-licenseBadge",attrs:{src:e.defaults.licenseBadges[i.uri]}}):t("span",[e._v(" "+e._s(i.uri)+" ")])])])}),e.licenseAttribution(e._item)?t("span",[e._v(" by "),e.licenseAttribution(e._item).url?t("a",{attrs:{href:e.licenseAttribution(e._item).url,target:"_blank"}},[t("auto-link",{attrs:{link:e.licenseAttribution(e._item).label}})],1):t("span",[t("auto-link",{attrs:{link:e.licenseAttribution(e._item).label}})],1)]):e._e()],2):e._e(),e._l([e._item.uri].concat(e._item.identifier).filter(function(i){return i!=null}),function(i,n){return t("div",{key:"schemeDetail-"+e.isLeft+"-identifier-"+n,staticClass:"schemeDetail-identifier"},[t("font-awesome-icon",{attrs:{icon:i.startsWith("http")?"link":"id-card"}}),t("auto-link",{attrs:{link:i}})],1)}),t("div",{staticClass:"schemeDetail-identifier"},[e._item.created?t("span",[t("b",[e._v(e._s(e.$t("conceptDetail.created"))+":")]),e._v(" "),t("date-string",{attrs:{date:e._item.created}})],1):e._e(),e._item.issued?t("span",[t("b",[e._v(e._s(e.$t("conceptDetail.issued"))+":")]),e._v(" "),t("date-string",{attrs:{date:e._item.issued}})],1):e._e(),e._item.modified?t("span",[t("b",[e._v(e._s(e.$t("conceptDetail.modified"))+":")]),e._v(" "),t("date-string",{attrs:{date:e._item.modified}})],1):e._e()]),e._item.languages?t("div",{staticClass:"schemeDetail-identifier"},[t("b",[e._v(e._s(e.$t("schemeDetail.languages"))+":")]),e._v(" "+e._s(e._item.languages.join(", "))+" ")]):e._e(),e._item.type&&e._item.type.length>1?t("div",{staticClass:"schemeDetail-identifier"},[t("b",[e._v(e._s(e.$t("general.type"))+":")]),e._l(e._item.type.filter(function(i){return i!="http://www.w3.org/2004/02/skos/core#ConceptScheme"}),function(i,n){return t("span",{key:"schemeDetail-"+e.isLeft+"-type-"+n},[e._v(" "+e._s(e.$jskos.prefLabel(e.kosTypes.find(function(o){return o.uri==i}),{language:e.locale})||i)+" "),n!=e._item.type.length-2?t("span",[e._v(" / ")]):e._e()])})],2):e._e(),t("div",{staticClass:"schemeDetail-identifier"},[t("b",[e._v(e._s(e.$t("schemeDetail.registry"))+": ")]),t("registry-notation",{attrs:{registry:e._item._registry,tooltip:!1}}),e._v(" \xA0 "),t("registry-name",{attrs:{registry:e._item._registry,tooltip:!1}})],1),e.$jskos.notation(e._item)?t("div",{staticClass:"schemeDetail-identifier"},[t("a",{attrs:{href:""},on:{click:function(i){i.preventDefault(),e.$emit("searchMappings",{fromScheme:e.isLeft?e.$jskos.notation(e._item):null,fromNotation:e.isLeft?"":null,toScheme:e.isLeft?null:e.$jskos.notation(e._item),toNotation:e.isLeft?null:"",direction:"both"})}}},[t("font-awesome-icon",{attrs:{icon:"external-link-square-alt"}}),e._v(e._s(e.$t("schemeDetail.availableMappings"))+" ")],1)]):e._e(),e.settings.showTopConceptsInScheme&&e.topConcepts[e._item.uri]&&e.topConcepts[e._item.uri].length>0?t("item-detail-narrower",{attrs:{narrower:e.topConcepts[e._item.uri],"is-left":e.isLeft,text:"Top Concepts:"}}):e.settings.showTopConceptsInScheme?t("div",[e._v(" "+e._s(e.$t("schemeDetail.noTopConcepts"))+" ")]):e._e()],2)},Ut=[];const Vt={name:"SchemeDetail",components:{AutoLink:X,ItemName:C,ItemDetailNarrower:le,RegistryName:Ht,RegistryNotation:Me,DateString:Y},mixins:[g],props:{item:{type:Object,default:null},isLeft:{type:Boolean,default:!0},settings:{type:Object,default:()=>({})}},data(){return{kosTypes:he}},computed:{_item(){return p(this.item)||this.item}},methods:{licenseAttribution(e){let s=e.publisher;return!s||s.length==0?null:{url:s[0].url||s[0].uri,label:this.$jskos.prefLabel(s[0])}}}},ue={};var Kt=d(Vt,Wt,Ut,!1,Gt,"e7b41b16",null,null);function Gt(e){for(let s in ue)this[s]=ue[s]}var qt=function(){return Kt.exports}(),Qt=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"itemDetail",on:{dragover:e.dragOver,drop:e.drop}},[t("minimizer",{attrs:{name:"itemDetail_"+e.isLeft,text:e.type+" Detail"}}),e._item!=null?t("div",{staticClass:"itemDetail-content"},[t(e.type=="Concept"?"ConceptDetail":"SchemeDetail",{tag:"component",attrs:{item:e._item,"is-left":e.isLeft,settings:e.internalSettings},on:{searchMappings:function(i){return e.$emit("searchMappings",i)},searchConcept:function(i){return e.$emit("searchConcept",i)}}})],1):e.loading?e._e():t("div",{staticClass:"fillAndCenter fontSize-normal fontWeight-heavy"},[e._v(" "+e._s(e.$t("itemDetail.pleaseSelect"))+" ")]),t("component-settings"),t("data-modal-button",{attrs:{data:e._item,"position-right":20,url:e.apiUrl}}),e.loading?t("loading-indicator-full"):e._e()],1)},Jt=[];const Xt={name:"ItemDetail",components:{LoadingIndicatorFull:z,Minimizer:R,ConceptDetail:At,SchemeDetail:qt,DataModalButton:Q,ComponentSettings:I},mixins:[g,M,v],props:{item:{type:Object,default:null},isScheme:{type:Boolean,default:!1},isLeft:{type:Boolean,default:!0},settings:{type:Object,default:()=>({})}},data(){return{loading:!1,defaultSettings:{showGndTerms:!0,showSchemeInAncestors:!0,showTopConceptsInScheme:!1,showAllAncestors:!1,showAllNotes:!1}}},computed:{_item(){return p(this.item,{relatedItems:!0})||this.item},type(){return this.$jskos.isConcept(this._item)?"Concept":"Scheme"},internalSettings(){return Object.assign({},this.defaultSettings,{showAllAncestors:this.componentSettings.showAllAncestors},this.settings)},apiUrl(){if(!this._item||!this._item.uri)return null;try{let e;if(this.$jskos.isScheme(this._item)){const s=r.get(this._item,"inScheme[0]._registry")||r.get(this._item,"_registry");e=r.get(s,"_api.schemes")||r.get(s,"_api.data")||r.get(s,"_api.concepts")}else{const s=r.get(this._item,"inScheme[0]._registry");e=r.get(s,"_api.data")||r.get(s,"_getDataUrl")&&s._getDataUrl(this._item)||r.get(s,"_api.concepts")}return!e||!r.isString(e)?null:`${e}${e.includes("?")?"&":"?"}uri=${encodeURIComponent(this._item.uri)}`}catch{return null}}},watch:{_item:function(){this.scrollToTop()}},mounted(){this.scrollToTop()},methods:{droppedConcept(e){this.setSelected({concept:e,isLeft:this.isLeft})},scrollToTop(){Array.prototype.forEach.call(this.$el.getElementsByClassName("itemDetail-content"),e=>{e.scrollTop=0})}}},de={};var Yt=d(Xt,Qt,Jt,!1,Zt,"3b238b20",null,null);function Zt(e){for(let s in de)this[s]=de[s]}var ei=function(){return Yt.exports}(),ti=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.$t("general.resizingSlider"),delay:e.defaults.delay.medium,placement:e.isColumn?"right":"top"},expression:"{ title: $t('general.resizingSlider'), delay: defaults.delay.medium, placement: isColumn ? 'right' : 'top' }",modifiers:{hover:!0}}],class:{resizingSliderCol:e.isColumn,resizingSliderRow:!e.isColumn},on:{mousedown:e.startResizing}},[t("div",[t("font-awesome-icon",{attrs:{icon:e.isColumn?"ellipsis-v":"ellipsis-h"}})],1)])},ii=[];const si={name:"ResizingSlider",mixins:[v],props:{isColumn:{type:Boolean,default:!1}},data(){return{resizing:!1,savedValues:{}}},computed:{flex(){return this.$settings.flex||{}}},watch:{flex(){this.refreshFlex()}},mounted(){this.refreshFlex()},methods:{getSiblings(){let e=this.$el,s=e.parentElement,t=window.getComputedStyle(e),i=t.getPropertyValue("order"),n,o;try{i=parseInt(i)}catch{i=0}for(i>0?(n=s.querySelector(".order"+(i-1)),o=s.querySelector(".order"+(i+1))):(n=e.previousElementSibling,o=e.nextElementSibling);n&&(n.classList.contains("resizingSliderRow")||n.classList.contains("resizingSliderColumn"));)n=n.previousElementSibling;for(;o&&(o.classList.contains("resizingSliderRow")||o.classList.contains("resizingSliderColumn"));)o=o.nextElementSibling;return[n,o]},startResizing(e){let[s,t]=this.getSiblings();if(s==null||t==null)return;let i=s.clientWidth,n=t.clientWidth,o=s.clientHeight,a=t.clientHeight,l=i+n,c=o+a,h=window.getComputedStyle(s),m=window.getComputedStyle(t),_=parseFloat(h.getPropertyValue("flex-grow"))+parseFloat(m.getPropertyValue("flex-grow")),N=parseInt(h.getPropertyValue("min-width")),O=parseInt(m.getPropertyValue("min-width")),P=parseInt(h.getPropertyValue("min-height")),H=parseInt(m.getPropertyValue("min-height")),w=parseInt(r.get(s,"dataset.minimized"))||0,k=parseInt(r.get(t,"dataset.minimized"))||0;if(w+k==2)return;w+k==0&&(this.savedValues.previousWidth=i,this.savedValues.nextWidth=n,this.savedValues.previousHeight=o,this.savedValues.nextHeight=a);let u=this;function F(){document.removeEventListener("mousemove",W),document.onmouseup=null,document.body.style.cursor="auto",document.body.style.userSelect="auto",document.body.style.webkitUserSelect="auto",u.resizing=!1}if(this.resizing){F();return}this.resizing=!0;let we=u.isColumn?e.clientX:e.clientY;document.body.style.cursor=u.isColumn?"col-resize":"row-resize",document.body.style.userSelect="none",document.body.style.webkitUserSelect="none";function W(U){let j=(u.isColumn?U.clientX:U.clientY)-we;if(u.isColumn){let f=i+j,y=n-j;if(f<N||y<O||w+k==1){if(f<=10||y<=10||f>=N*3&&w==1||y>=O*3&&k==1){let S=f<=10||w==1?s:t,b=S.getElementsByClassName("minimizer")[0];if(b.parentElement!=S&&b.parentElement.parentElement!=S)return;let x=b.__vue__;x&&(s.style.flex=u.savedValues.previousWidth/l*_,u.saveFlex(s),t.style.flex=u.savedValues.nextWidth/l*_,u.saveFlex(t),x.toggleMinimize(),F())}return}s.style.flex=f/l*_,u.saveFlex(s),t.style.flex=y/l*_,u.saveFlex(t)}else{let f=o+j,y=a-j;if(f<P||y<H||w+k==1){if(f<=10||y<=10||f>=P*3&&w==1||y>=H*3&&k==1){let S=f<=10||w==1?s:t,b=S.getElementsByClassName("minimizer")[0];if(b.parentElement!=S&&b.parentElement.parentElement!=S)return;let x=b.__vue__;x&&(s.style.flex=u.savedValues.previousHeight/c*_,u.saveFlex(s),t.style.flex=u.savedValues.nextHeight/c*_,u.saveFlex(t),x.toggleMinimize(),F())}return}s.style.flex=f/c*_,u.saveFlex(s),t.style.flex=y/c*_,u.saveFlex(t)}}document.addEventListener("mousemove",W),document.onmouseup=F},saveFlex(e){if(e&&e.id&&e.style){let s=r.cloneDeep(this.$settings.flex);s[e.id]=e.style.flex,this.$store.commit({type:"settings/set",prop:"flex",value:s})}},refreshFlex(){let e=this.getSiblings();for(let s of e)!s||!s.id||this.flex[s.id]!=null&&(s.style.flex=this.flex[s.id])}}},me={};var ni=d(si,ti,ii,!1,oi,"5596b40b",null,null);function oi(e){for(let s in me)this[s]=me[s]}var ri=function(){return ni.exports}(),ai=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"conceptSearch",on:{mousemove:function(i){return e.mousemove()}}},[t("div",{staticClass:"conceptSearch-icon button",on:{click:e.focusSearch}},[t("font-awesome-icon",{attrs:{icon:"search"}})],1),t("div",{staticClass:"conceptSearch-inputWrapper"},[e.isOpen&&!e.loading?t("div",{staticClass:"conceptSearch-resultCount",style:"right: "+(e._scheme.types&&e._scheme.types.length?27:10)+"px;"},[e._v(" "+e._s(e.searchResult.length)+" "+e._s(e.$tc("search.results",e.searchResult.length))+" ")]):e._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:e._scheme.types&&e._scheme.types.length>0,expression:"_scheme.types && _scheme.types.length > 0"}],staticClass:"conceptSearch-filter button",attrs:{id:"conceptSearch-filter-"+(e.isLeft?"left":"right")}},[t("font-awesome-icon",{attrs:{icon:"filter"}})],1),t("b-popover",{attrs:{target:"conceptSearch-filter-"+(e.isLeft?"left":"right"),show:e.filterPopoverShow,triggers:"click",placement:"auto"},on:{"update:show":function(i){e.filterPopoverShow=i}}},[t("div",{ref:"filterPopover"},[t("b-form-checkbox-group",{staticClass:"conceptSearch-filterCheckboxes",attrs:{stacked:"",size:"sm"},model:{value:e.selectedTypes,callback:function(i){e.selectedTypes=i},expression:"selectedTypes"}},e._l(e._scheme.types,function(i){return t("b-form-checkbox",{key:i.uri,staticClass:"conceptSearch-filterCheckbox",attrs:{value:i.uri}},[e._v(" "+e._s(e.$jskos.prefLabel(i))+" ")])}),1)],1)]),t("b-form-input",{ref:"searchInput",attrs:{placeholder:e.$t("search.placeholder"),size:"sm",autocomplete:"off"},on:{dragover:e.dragOver,drop:function(i){return e.drop(i,e.isLeft)}},nativeOn:{click:function(i){e.isOpen=e.searchQuery!=""},keydown:[function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"down",40,i.key,["Down","ArrowDown"])?null:(i.preventDefault(),e.onArrowDown.apply(null,arguments))},function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"up",38,i.key,["Up","ArrowUp"])?null:(i.preventDefault(),e.onArrowUp.apply(null,arguments))},function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"tab",9,i.key,"Tab")?null:e.closeResults.apply(null,arguments)}],keyup:[function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"enter",13,i.key,"Enter")?null:e.onEnter.apply(null,arguments)},function(i){if(!i.type.indexOf("key")&&e._k(i.keyCode,"esc",27,i.key,["Esc","Escape"]))return null;e.$refs.searchInput.$el.blur(),e.closeResults()}],focus:function(i){e.isOpen=e.searchQuery!=""}},model:{value:e.searchQuery,callback:function(i){e.searchQuery=i},expression:"searchQuery"}}),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isOpen,expression:"isOpen"}],staticClass:"conceptSearch-results"},[e.loading?t("div",{staticClass:"conceptSearch-loading"},[t("loading-indicator")],1):t("ul",{staticClass:"conceptSearch-results-list"},[e._l(e.searchResult,function(i,n){return t("li",{key:n,staticClass:"conceptSearch-results-item",class:{"conceptSearch-selected":n===e.searchSelected,"font-italic":i[1]=="###conceptWithoutData###"},attrs:{id:e.uniqueID+"-searchResult-"+n,draggable:"true"},on:{dragstart:function(o){return e.dragStartResult(i,o)},dragend:e.dragEnd,click:function(o){return e.chooseResult(n)},mouseover:function(o){return e.mouseover(n)}}},[i[1]=="###conceptWithoutData###"?t("span",{staticClass:"fontSize-verySmall"},[t("font-awesome-icon",{attrs:{icon:"bolt"}})],1):e._e(),t("span",{domProps:{innerHTML:e._s(e.highlightQueryInResult(i[0]))}})])}),e.searchResult.length==0?t("li",{staticClass:"conceptSearch-results-item"},[t("div",[e._v(e._s(e.$t("search.noResults")))])]):e._e()],2)])],1)])},li=[];const ci={name:"ConceptSearch",components:{LoadingIndicator:D},mixins:[g,Z,M,v],props:{isLeft:{type:Boolean,default:!0},scheme:{type:Object,default:null}},data(){return{searchQuery:"",searchResult:[],isOpen:!1,isValid:!1,loading:!1,searchSelected:-1,preventHovering:!1,cancel:null,uniqueID:null,filterPopoverShow:!1}},computed:{_scheme(){return p(this.scheme)||this.scheme},typesForSchemes(){return this.$settings.typesForSchemes},selectedTypes:{get(){let e=Object.keys(this.$settings.typesForSchemes).find(s=>this.$jskos.compare(this._scheme,{uri:s}));return this.$settings.typesForSchemes[e]},set(e){if(!Array.isArray(e))return;let s=Object.keys(this.$settings.typesForSchemes).find(i=>this.$jskos.compare(this._scheme,{uri:i}))||this._scheme.uri,t=r.cloneDeep(this.$settings.typesForSchemes);r.isEqual(e,t[s])||(t[s]=e,this.$store.commit({type:"settings/set",prop:"typesForSchemes",value:t}))}},provider(){return r.get(this._scheme,"_registry")}},watch:{searchQuery:function(e){this.searchSelected=-1,this.cancel!=null&&(this.cancel("There was a newer search query."),this.cancel=null),e==""?(this.loading=!1,this.isOpen=!1):(this.searchResult=["Waiting for you to stop typing..."],this.loading=!0,this.isOpen=!0,this.debouncedGetAnswer()),this.isValid=!1},_scheme:function(e,s){this.$jskos.compare(s,e)||(this.searchQuery="",this.searchResult=[],this.isOpen=!1,this.isValid=!1,this.loading=!1,this.searchSelected=-1),e!=null&&this._loadTypes(e)},typesForSchemes(){this.loading=!0,this.getAnswer()}},created:function(){this.debouncedGetAnswer=r.debounce(this.getAnswer,300),this.uniqueID=this.generateID()},methods:{clickHandlers(){return[{elements:[this.$el],handler:()=>{this.filterPopoverShow||(this.isOpen=!1,this.searchSelected=-1)}},{elements:[document.getElementById(`conceptSearch-filter-${this.isLeft?"left":"right"}`),this.$refs.filterPopover],handler:()=>{this.filterPopoverShow=!1}}]},chooseResult(e){this.closeResults(),this.searchSelected=-1;const s=r.last(this.searchResult[e]);if(!s)return;let t={uri:s,inScheme:[this._scheme]};t=L(t,{type:"concept",scheme:this._scheme,provider:this.provider}),this.setSelected({concept:t,isLeft:this.isLeft}),document.activeElement!=document.body&&document.activeElement.blur()},closeResults(){this.isOpen=!1},getAnswer:function(){this.searchResult=[];let e=this.searchQuery;const s=this.provider.suggest({search:e,scheme:this._scheme,types:this.selectedTypes});this.cancel=s.cancel,s.then(t=>{e==this.searchQuery&&(this.loading=!1,this.searchResult=r.zip(t[1],t[2],t[3]),this.isValid=!0)}).catch(t=>{if(t.toString().toLowerCase().indexOf("cancel")==-1&&e==this.searchQuery){this.loading=!1,this.isValid=!1;const i=`${this.$t("search.error")} ${this.getErrorMessage(t)}`;this.searchResult=[[i]]}}).then(()=>{if(e==this.searchQuery){let t,i;try{t=new this.$jskos.ConceptScheme(this._scheme),i=t.conceptFromNotation(e)}catch(n){this.$log.warn("ConceptSearch: Error creating concept from query as notation.",n)}i&&!this.searchResult.find(n=>r.last(n)==i.uri)&&this.searchResult.push([`${e} ${this.$t("itemDetail.unknownConcept")}`,"###conceptWithoutData###",i.uri]),this.cancel=null}})},onArrowDown(){this.preventHovering=!0,this.searchSelected>=this.searchResult.length-1?this.searchSelected=0:this.searchSelected+=1,this.scrollSelectedIntoView()},onArrowUp(){this.preventHovering=!0,this.searchSelected<=0?this.searchSelected=this.searchResult.length-1:this.searchSelected-=1,this.scrollSelectedIntoView()},scrollSelectedIntoView(){let e=document.getElementById(this.uniqueID+"-searchResult-"+this.searchSelected);var s=e.getBoundingClientRect(),t=e.parentElement.parentElement.getBoundingClientRect();s.bottom>t.bottom&&e.scrollIntoView(!1),s.top<t.top&&e.scrollIntoView()},onEnter(){let e;this.loading||!this.isValid||this.searchResult.length==0||(this.searchSelected<0||this.searchSelected>=this.searchResult.length?e=0:e=this.searchSelected,this.chooseResult(e))},mouseover(e){this.preventHovering||(this.searchSelected=e)},mousemove(){this.preventHovering=!1},focusSearch(){this.$refs.searchInput.focus(),this.isOpen=this.searchQuery!=""},highlightQueryInResult(e){if(!this.searchQuery.length)return e;let s=this.searchQuery,t=new RegExp(s,"ig"),i=t.exec(e),n=0,o="";for(;i;){let a=i.index;o+=r.escape(e.slice(n,a))+"<span class='conceptSearch-searchHighlight fontWeight-heavy'>"+r.escape(e.slice(a,a+s.length))+"</span>",n=a+s.length,i=t.exec(e)}return o+=r.escape(e.slice(n)),o},setSearchQuery(e,s=!1){this.searchQuery=e,this.$nextTick(()=>{this.isOpen=s}),setTimeout(()=>{s&&this.focusSearch()},10)},_loadTypes(e){Fe(e).then(s=>{this.selectedTypes||(this.selectedTypes=s.map(t=>t.uri))})},dragStartResult(e,s){let t=r.last(e),i=L({uri:t},{scheme:this._scheme,type:"concept"});this.dragStart(i,s)},droppedConcept(e){this.setSearchQuery(this.$jskos.prefLabel(e,{fallbackToUri:!0}))}}},fe={};var pi=d(ci,ai,li,!1,hi,"6a8e5ef6",null,null);function hi(e){for(let s in fe)this[s]=fe[s]}var ui=function(){return pi.exports}(),di=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("font-awesome-icon",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.$jskos.isContainedIn(e.scheme,e.favoriteSchemes)?e.$t("schemeSelection.starRemove"):e.$t("schemeSelection.starAdd"),delay:e.defaults.delay.medium},expression:"{ title: $jskos.isContainedIn(scheme, favoriteSchemes) ? $t('schemeSelection.starRemove') : $t('schemeSelection.starAdd'), delay: defaults.delay.medium }",modifiers:{hover:!0}}],staticClass:"pointer",class:e.$jskos.isContainedIn(e.scheme,e.favoriteSchemes)?"starFavorite":"starNormal",attrs:{icon:"star"},on:{click:function(i){return e.toggleFavoriteScheme(e.scheme)}}}),t("item-name",{attrs:{item:e.scheme,"is-link":!0,"is-left":e.isLeft},nativeOn:{click:function(i){return e.hidePopover.apply(null,arguments)}}})],1)},mi=[];const fi={name:"ConceptSchemeSelectionItem",components:{ItemName:C},props:{source:{type:Object,required:!0},index:{type:Number,required:!0},favoriteSchemes:{type:Array,required:!0},toggleFavoriteScheme:{type:Function,required:!0},hidePopover:{type:Function,required:!0},isLeft:{type:Boolean,required:!0}},computed:{scheme(){return p(this.source)}}},ge={};var gi=d(fi,di,mi,!1,vi,null,null,null);function vi(e){for(let s in ge)this[s]=ge[s]}var yi=function(){return gi.exports}(),_i=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"conceptSchemeSelection",staticStyle:{overflow:"visible"},attrs:{id:"conceptSchemeSelection-"+e.id}},[t("component-settings"),e.scheme?t("div",{staticClass:"conceptSchemeSelection-collapsed"},[t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.popoverShown?e.$t("schemeSelection.popoverHide"):e.$t("schemeSelection.popoverShow"),delay:e.defaults.delay.medium},expression:"{ title: popoverShown ? $t('schemeSelection.popoverHide') : $t('schemeSelection.popoverShow'), delay: defaults.delay.medium }",modifiers:{hover:!0}}],staticClass:"conceptSchemeSelection-expandButton button",attrs:{id:e.id+"-expandButton"},on:{click:e.togglePopover}},[t("font-awesome-icon",{attrs:{icon:e.popoverShown?"angle-left":"angle-down"}})],1),t("div",{staticClass:"conceptSchemeSelection-schemeName"},[t("font-awesome-icon",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.$jskos.isContainedIn(e.scheme,e.favoriteSchemes)?e.$t("schemeSelection.starRemove"):e.$t("schemeSelection.starAdd"),delay:e.defaults.delay.medium},expression:"{ title: $jskos.isContainedIn(scheme, favoriteSchemes) ? $t('schemeSelection.starRemove') : $t('schemeSelection.starAdd'), delay: defaults.delay.medium }",modifiers:{hover:!0}}],staticClass:"pointer",class:e.$jskos.isContainedIn(e.scheme,e.favoriteSchemes)?"starFavorite":"starNormal",attrs:{icon:"star"},on:{click:function(i){return e.toggleFavoriteScheme(e.scheme)}}}),e._v(" \xA0 "),t("item-name",{attrs:{item:e.scheme,"is-link":!0,"is-left":e.isLeft,"font-size":"large"}}),e.scheme.license&&e.scheme.license.length?t("span",{staticStyle:{display:"inline-block",margin:"0px 2px 0px 1px",height:"15px"}},[e.defaults.licenseBadges[e.scheme.license[0].uri]?t("img",{staticStyle:{"vertical-align":"text-top"},attrs:{src:e.defaults.licenseBadges[e.scheme.license[0].uri]}}):e._e()]):e._e(),t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.$t("general.clearScheme"),delay:e.defaults.delay.medium},expression:"{ title: $t('general.clearScheme'), delay: defaults.delay.medium }",modifiers:{hover:!0}}],staticClass:"button",staticStyle:{display:"inline-block",margin:"-3px 2px 0px 2px"},on:{click:e.clearScheme}},[t("font-awesome-icon",{attrs:{icon:"times-circle"}})],1)],1),t("concept-search",{ref:"conceptSearch",staticClass:"conceptSchemeSelection-conceptSearch",attrs:{"is-left":e.isLeft,scheme:e.scheme}})],1):e._e(),t(e.scheme==null?"div":"b-popover",{tag:"div",staticClass:"conceptSchemeSelection-popover",attrs:{target:e.id+"-expandButton",container:"conceptSchemeSelection-"+e.id,triggers:"disabled",placement:"leftbottom"},on:{shown:function(i){e.popoverShown=!0},hidden:function(i){e.popoverShown=!1}}},[t("div",{ref:"popover",staticClass:"conceptSchemeSelection-expanded",class:{"conceptSchemeSelection-expanded-div":e.scheme==null,"conceptSchemeSelection-expanded-popover":e.scheme!=null}},[t("div",{staticClass:"componentTitle"},[e._v(" "+e._s(e.isLeft?e.$t("schemeSelection.source"):e.$t("schemeSelection.target"))+" ")]),t("b-form",{attrs:{inline:""},on:{submit:e.chooseFirst}},[t("b-form-input",{ref:"input",staticStyle:{flex:"1","margin-right":"5px"},attrs:{placeholder:e.$t("schemeSelection.schemeFilterPlaceholder"),autocomplete:"off",size:"sm"},nativeOn:{keyup:function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"esc",27,i.key,["Esc","Escape"])?null:e.hidePopover.apply(null,arguments)}},model:{value:e.schemeFilter,callback:function(i){e.schemeFilter=i},expression:"schemeFilter"}}),t("div",{staticClass:"button",staticStyle:{position:"relative"},attrs:{id:"conceptSchemeSelection-filterButton-"+e.id}},[t("font-awesome-icon",{attrs:{icon:"filter"}}),e.isFiltered?t("span",{staticClass:"text-success",staticStyle:{position:"absolute",top:"-10px",right:"-5px"}},[e._v(" \u2022 ")]):e._e()],1),t("b-popover",{attrs:{target:"conceptSchemeSelection-filterButton-"+e.id,show:e.filterPopoverShow,triggers:"click",placement:"auto"},on:{"update:show":function(i){e.filterPopoverShow=i}}},[t("div",{ref:"filterPopover",staticClass:"conceptSchemeSelection-filterPopover scrollable"},[t("p",{staticClass:"fontWeight-heavy"},[e._v(" "+e._s(e.$t("schemeSelection.filter"))+" ")]),t("p",{directives:[{name:"show",rawName:"v-show",value:e.isFiltered,expression:"isFiltered"}]},[t("a",{ref:"removeAllFiltersLink",attrs:{href:""},on:{click:function(i){i.preventDefault(),e.onlyFavorites=!1,e.schemeFilter="",e.registryFilter=e.availableRegistries.map(function(n){return n.uri}),e.languageFilter=e.availableLanguages.concat([null]),e.typeFilter=e.availableTypes.concat([null])}}},[e._v(" "+e._s(e.$t("schemeSelection.filtersRemove"))+" ")])]),e.allowFavoriteSchemesFilter?t("b-form-checkbox",{attrs:{size:"sm"},model:{value:e.onlyFavorites,callback:function(i){e.onlyFavorites=i},expression:"onlyFavorites"}},[e._v(" "+e._s(e.$t("schemeSelection.filterOnlyFavorites"))+" ")]):e._e(),t("div",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"conceptSchemeSelection-filterPopover-"+e.id+"-registryFilterCollapse",expression:"`conceptSchemeSelection-filterPopover-${id}-registryFilterCollapse`"}],staticClass:"button"},[t("span",{staticClass:"when-opened"},[t("font-awesome-icon",{attrs:{icon:"angle-down"}})],1),t("span",{staticClass:"when-closed"},[t("font-awesome-icon",{attrs:{icon:"angle-right"}})],1),e._v(" "+e._s(e.$t("schemeSelection.registryFilter"))+" ("+e._s(e.registryFilter.length==e.availableRegistries.length?e.$t("general.all"):e.registryFilter.length)+") ")]),t("b-collapse",{attrs:{id:"conceptSchemeSelection-filterPopover-"+e.id+"-registryFilterCollapse"}},[t("a",{attrs:{href:""},on:{click:function(i){i.preventDefault(),e.registryFilter=e.availableRegistries.map(function(n){return n.uri})}}},[e._v(" "+e._s(e.$t("schemeSelection.filterSelectAll"))+" ")]),e._v("\u2022 "),t("a",{attrs:{href:""},on:{click:function(i){i.preventDefault(),e.registryFilter=[]}}},[e._v(" "+e._s(e.$t("schemeSelection.filterDeselectAll"))+" ")]),e._l(e.registryFilterOptions,function(i){return t("b-form-checkbox",{key:"conceptSchemeSelection-filterPopover-"+e.id+"-registryFilter-"+i.value,staticClass:"fontSize-normal",attrs:{value:i.value,size:"sm",stacked:""},on:{change:e.focusAndSelectInput},model:{value:e.registryFilter,callback:function(n){e.registryFilter=n},expression:"registryFilter"}},[e._v(" "+e._s(i.text)+" ")])})],2),t("div",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"conceptSchemeSelection-filterPopover-"+e.id+"-languageFilterCollapse",expression:"`conceptSchemeSelection-filterPopover-${id}-languageFilterCollapse`"}],staticClass:"button"},[t("span",{staticClass:"when-opened"},[t("font-awesome-icon",{attrs:{icon:"angle-down"}})],1),t("span",{staticClass:"when-closed"},[t("font-awesome-icon",{attrs:{icon:"angle-right"}})],1),e._v(" "+e._s(e.$t("schemeSelection.languageFilter"))+" ("+e._s(e.languageFilter.length-1==e.availableLanguages.length?e.$t("general.all"):e.languageFilter.length)+") ")]),t("b-collapse",{attrs:{id:"conceptSchemeSelection-filterPopover-"+e.id+"-languageFilterCollapse"}},[t("a",{attrs:{href:""},on:{click:function(i){i.preventDefault(),e.languageFilter=e.availableLanguages.concat([null])}}},[e._v(" "+e._s(e.$t("schemeSelection.filterSelectAll"))+" ")]),e._v("\u2022 "),t("a",{attrs:{href:""},on:{click:function(i){i.preventDefault(),e.languageFilter=[]}}},[e._v(" "+e._s(e.$t("schemeSelection.filterDeselectAll"))+" ")]),e._l(e.languageFilterOptions,function(i){return t("b-form-checkbox",{key:"conceptSchemeSelection-filterPopover-"+e.id+"-languageFilter-"+i.value,staticClass:"fontSize-normal",attrs:{value:i.value,size:"sm",stacked:""},on:{change:e.focusAndSelectInput},model:{value:e.languageFilter,callback:function(n){e.languageFilter=n},expression:"languageFilter"}},[e._v(" "+e._s(i.text)+" ")])})],2),t("div",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"conceptSchemeSelection-filterPopover-"+e.id+"-typeFilterCollapse",expression:"`conceptSchemeSelection-filterPopover-${id}-typeFilterCollapse`"}],staticClass:"button"},[t("span",{staticClass:"when-opened"},[t("font-awesome-icon",{attrs:{icon:"angle-down"}})],1),t("span",{staticClass:"when-closed"},[t("font-awesome-icon",{attrs:{icon:"angle-right"}})],1),e._v(" "+e._s(e.$t("schemeSelection.typeFilter"))+" ("+e._s(e.typeFilter.length-1==e.availableTypes.length?e.$t("general.all"):e.typeFilter.length)+") ")]),t("b-collapse",{attrs:{id:"conceptSchemeSelection-filterPopover-"+e.id+"-typeFilterCollapse"}},[t("a",{attrs:{href:""},on:{click:function(i){i.preventDefault(),e.typeFilter=e.availableTypes.concat([null])}}},[e._v(" "+e._s(e.$t("schemeSelection.filterSelectAll"))+" ")]),e._v("\u2022 "),t("a",{attrs:{href:""},on:{click:function(i){i.preventDefault(),e.typeFilter=[]}}},[e._v(" "+e._s(e.$t("schemeSelection.filterDeselectAll"))+" ")]),e._l(e.typeFilterOptions,function(i){return t("b-form-checkbox",{key:"conceptSchemeSelection-filterPopover-"+e.id+"-typeFilter-"+i.value,staticClass:"fontSize-normal",attrs:{value:i.value,size:"sm",stacked:""},on:{change:e.focusAndSelectInput},model:{value:e.typeFilter,callback:function(n){e.typeFilter=n},expression:"typeFilter"}},[e._v(" "+e._s(i.text)+" ")])})],2)],1)])],1),t("virtual-list",{staticClass:"conceptSchemeSelection-schemeList scrollable",attrs:{"data-key":"uri","data-sources":e.filteredSchemes,"data-component":e.itemComponent,keeps:50,"item-class":"conceptSchemeSelection-schemeList-item","extra-props":{isLeft:e.isLeft,hidePopover:e.hidePopover,favoriteSchemes:e.favoriteSchemes,toggleFavoriteScheme:e.toggleFavoriteScheme}}},[t("template",{slot:"footer"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.isFiltered&&e.filteredSchemes.length<e.schemes.length,expression:"isFiltered && filteredSchemes.length < schemes.length"}],staticClass:"conceptSchemeSelection-schemeList-item"},[t("a",{ref:"showAllSchemesLink",attrs:{href:""},on:{click:function(i){i.preventDefault(),e.onlyFavorites=!1,e.schemeFilter="",e.registryFilter=e.availableRegistries.map(function(n){return n.uri}),e.languageFilter=e.availableLanguages.concat([null]),e.typeFilter=e.availableTypes.concat([null])}}},[e._v(" "+e._s(e.$t("schemeSelection.showAllSchemes",{count:e.schemes.length}))+" ")])])])],2)],1)])],1)},wi=[];const Si={name:"ConceptSchemeSelection",components:{ItemName:C,ConceptSearch:ui,ComponentSettings:I,VirtualList:ee},mixins:[g,Z,B,v],props:{isLeft:{type:Boolean,default:!0}},data(){return{id:this.generateID(),popoverShown:!1,filterPopoverShow:!1,schemeFilter:"",registryFilter:[],languageFilter:[],typeFilter:[],onlyFavorites:!0,itemComponent:yi,shownRegistries:[],shownLanguages:[],shownTypes:[],registryFilterOptions:[],languageFilterOptions:[],typeFilterOptions:[],filteredSchemes:[]}},computed:{scheme(){return p(this.selected.scheme[this.isLeft])},_schemes(){return E(this.schemes)},isFiltered(){return this.schemeFilter!=""||this.registryFilter.length<this.availableRegistries.length||this.languageFilter.length-1<this.availableLanguages.length||this.typeFilter.length-1<this.availableTypes.length||this.onlyFavorites},availableRegistries(){return this.config.registries.filter(e=>e.has.concepts)},availableLanguages(){return r.uniq([].concat(...this._schemes.map(e=>e.languages||[]))).sort()},availableTypes(){return r.uniq(r.flatten(this._schemes.map(e=>e.type||[]))).filter(e=>e&&e!="http://www.w3.org/2004/02/skos/core#ConceptScheme")},allowFavoriteSchemesFilter(){return!!this.favoriteSchemes.find(e=>this.$jskos.isContainedIn(e,this._schemes))}},watch:{popoverShown(e){e&&r.delay(()=>{this.focusAndSelectInput()},100)},allowFavoriteSchemesFilter(e){e||(this.onlyFavorites=!1)},schemes:{handler(){this.updateProperties()},deep:!0},schemeFilter:{handler(){this.updateProperties()},deep:!0},registryFilter:{handler(){this.updateProperties()},deep:!0},languageFilter:[function(){this.schemeFilter=""},{handler(){this.updateProperties()},deep:!0}],typeFilter:[function(){this.schemeFilter=""},{handler(){this.updateProperties()},deep:!0}],availableRegistries(){this.updateProperties()},onlyFavorites(){this.schemeFilter="",this.updateProperties()},favoriteSchemes(){this.updateProperties()}},mounted(){this.updateProperties=r.debounce(this._updateProperties,100),this.enableShortcuts(),this.registryFilter=this.availableRegistries.map(e=>e.uri),this.languageFilter=this.availableLanguages.concat([null]),this.typeFilter=this.availableTypes.concat([null]),this.allowFavoriteSchemesFilter||(this.onlyFavorites=!1)},methods:{clickHandlers(){return[{elements:[this.$refs.popover,document.getElementById(`${this.id}-expandButton`),this.$refs.showAllSchemesLink,document.getElementById(`conceptSchemeSelection-filterButton-${this.id}`),this.$refs.filterPopover,this.$refs.removeAllFiltersLink],handler:()=>{this.hidePopover()}},{elements:[document.getElementById(`conceptSchemeSelection-filterButton-${this.id}`),this.$refs.filterPopover,this.$refs.removeAllFiltersLink],handler:()=>{this.filterPopoverShow=!1}}]},shortcutHandler({action:e,isLeft:s}){if(this.isLeft===s)switch(e){case"openSchemeSelection":this.scheme?this.togglePopover():this.focusAndSelectInput();break;case"openConceptSearch":this.$refs.conceptSearch&&this.$refs.conceptSearch.focusSearch();break}},_updateProperties(){let e,s;e=this._schemes.filter(i=>(this.languageFilter.includes(null)&&!(i.languages||[]).length||r.intersection(i.languages||[],this.languageFilter).length)&&(this.typeFilter.includes(null)&&(i.type||[]).length<=1||r.intersection(i.type||[],this.typeFilter).length)&&(!this.onlyFavorites||this.$jskos.isContainedIn(i,this.favoriteSchemes))),this.shownRegistries=this.availableRegistries.filter(i=>e.find(n=>this.$jskos.compareFast(i,n._registry))),e=this._schemes.filter(i=>(this.registryFilter.length==this.availableRegistries.length||this.registryFilter.find(n=>this.$jskos.compareFast({uri:n},i._registry)))&&(this.typeFilter.includes(null)&&(i.type||[]).length<=1||r.intersection(i.type||[],this.typeFilter).length)&&(!this.onlyFavorites||this.$jskos.isContainedIn(i,this.favoriteSchemes))),this.shownLanguages=r.uniq([].concat(...e.map(i=>i.languages||[]))).sort(),e=this._schemes.filter(i=>(this.registryFilter.length==this.availableRegistries.length||this.registryFilter.find(n=>this.$jskos.compareFast({uri:n},i._registry)))&&(this.languageFilter.includes(null)&&!(i.languages||[]).length||r.intersection(i.languages||[],this.languageFilter).length)&&(!this.onlyFavorites||this.$jskos.isContainedIn(i,this.favoriteSchemes))),this.shownTypes=r.uniq(r.flatten(e.map(i=>i.type||[]))).filter(i=>i&&i!="http://www.w3.org/2004/02/skos/core#ConceptScheme"),this.registryFilterOptions=this.shownRegistries.map(i=>({value:i.uri,text:this.$jskos.prefLabel(i)})),s=[],this._schemes.find(i=>!i.languages||!i.languages.length)&&s.push({value:null,text:this.$t("schemeSelection.filterOther")}),s=this.shownLanguages.map(i=>({value:i,text:i})).concat(s),this.languageFilterOptions=s,s=[],this._schemes.find(i=>!i.type||i.type.length<=1)&&s.push({value:null,text:this.$t("schemeSelection.filterOther")}),s=this.shownTypes.map(i=>({value:i,text:i})).concat(s);for(let i of s){let n=he.find(o=>o.uri==i.value);n&&(i.text=this.$jskos.prefLabel(n,{language:this.locale}))}this.typeFilterOptions=s;let t=this.schemeFilter.toLowerCase();if(t){const i=n=>r.flattenDeep(r.concat([],Object.values(n.prefLabel||{}),Object.values(n.altLabel||{}),n.notation||[])).map(o=>o.toLowerCase());this.filteredSchemes=this._schemes.filter(n=>i(n).find(o=>o.startsWith(t)))}else this.filteredSchemes=this._schemes.filter(i=>(this.registryFilter.length==this.availableRegistries.length||this.registryFilter.find(n=>this.$jskos.compareFast({uri:n},i._registry)))&&(this.languageFilter.includes(null)&&!(i.languages||[]).length||r.intersection(i.languages||[],this.languageFilter).length)&&(this.typeFilter.includes(null)&&(i.type||[]).length<=1||r.intersection(i.type||[],this.typeFilter).length)&&(!this.onlyFavorites||this.$jskos.isContainedIn(i,this.favoriteSchemes)))},clearScheme(){this.setSelected({isLeft:this.isLeft}),r.delay(()=>{this.focusAndSelectInput()},100)},chooseFirst(e){e.preventDefault();const s=this.filteredSchemes[0];!s||(this.setSelected({scheme:s,isLeft:this.isLeft}),this.hidePopover())},setConceptSearchQuery(e,s=!1){this.$refs.conceptSearch&&this.$refs.conceptSearch.setSearchQuery(e,s)},toggleFavoriteScheme(e){this.$jskos.isContainedIn(e,this.favoriteSchemes)?this.$store.dispatch("removeSchemeFromFavorites",e):this.$store.dispatch("addSchemeToFavorites",e),this.focusAndSelectInput()},focusAndSelectInput(){let e=this.$refs.input&&this.$refs.input.$el;e&&(e.focus(),e.select())},showPopover(){this.$root.$emit("bv::show::popover",`${this.id}-expandButton`)},hidePopover(){this.$root.$emit("bv::hide::popover",`${this.id}-expandButton`)},togglePopover(){this.popoverShown?this.hidePopover():this.showPopover()}}},ve={};var bi=d(Si,_i,wi,!1,Ci,"0352678a",null,null);function Ci(e){for(let s in ve)this[s]=ve[s]}var $i=function(){return bi.exports}(),ki=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"font-default",attrs:{id:"app"}},[t("div",{staticClass:"alertsContainer"},e._l(e.$store.state.alerts.alerts,function(i,n){return t("b-alert",{key:n,staticStyle:{display:"flex"},attrs:{variant:i.variant,show:i.countdown||!i.shouldCountdown,dismissible:!i.shouldCountdown,fade:""},on:{dismissed:function(o){return e.$store.commit({type:"alerts/setCountdown",alert:i,countdown:0})},"dismiss-count-down":function(o){return e.$store.commit({type:"alerts/setCountdown",alert:i,countdown:o})}}},[t("div",{staticStyle:{flex:"1"},domProps:{innerHTML:e._s(i.text)}}),i.buttonText?t("div",{staticClass:"fontWeight-heavy"},[t("a",{attrs:{href:""},domProps:{innerHTML:e._s(i.buttonText)},on:{click:function(o){return o.preventDefault(),i.buttonHandler(i,o)}}})]):e._e()])}),1),e.loadingGlobal||e.loading?t("loading-indicator-full"):e._e(),e.loaded?[t("the-navbar",{ref:"navbar"}),t("div",{directives:[{name:"show",rawName:"v-show",value:e.selected.scheme[!0]||e.selected.scheme[!1],expression:"selected.scheme[true] || selected.scheme[false]"},{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{title:e.$t("general.swapSides"),delay:e.defaults.delay.medium},expression:"{ title: $t('general.swapSides'), delay: defaults.delay.medium }",modifiers:{hover:!0}}],attrs:{id:"swapSides"},on:{click:e.swapSides}},[t("font-awesome-icon",{attrs:{icon:"exchange-alt"}})],1),t("div",{staticClass:"main"},[e.config.error?t("div",{staticClass:"flexbox-row configError fontSize-large"},[t("div",{domProps:{innerHTML:e._s(e.$t("general."+e.config.error,e.config))}})]):e.schemes.length?t("div",{staticClass:"flexbox-row"},[e._l([!0,!1],function(i,n){return t("div",{key:"browser-"+n,staticClass:"browser mainComponent",class:{order1:i,order5:!i},attrs:{id:"browserComponent_"+i}},[t("minimizer",{attrs:{name:"browserComponent_"+i,"is-column":!0}}),t("concept-scheme-selection",{ref:i?"conceptSchemeSelectionLeft":"conceptSchemeSelectionRight",refInFor:!0,staticClass:"mainComponent visualComponent",style:e.selected.scheme[i]!=null?"":"flex: 1;",attrs:{"is-left":i}}),e.selected.scheme[i]!=null?t("div",{staticClass:"conceptBrowser"},[t("item-detail",{staticClass:"mainComponent visualComponent conceptBrowserItem conceptBrowserItemDetail",attrs:{id:"itemDetailComponent_"+i,item:e.selected.concept[i]||e.selected.scheme[i],"is-left":i,settings:e.itemDetailSettings[i?"left":"right"]},on:{searchMappings:function(o){return e.searchMappings(o)},searchConcept:function(o){return e.setConceptSearchQuery(i,o,!0)}}}),t("resizing-slider"),t("concept-list-wrapper",{ref:i?"conceptListLeft":"conceptListRight",refInFor:!0,staticClass:"mainComponent visualComponent conceptBrowserItem conceptBrowserItemList",attrs:{id:"conceptListComponent_"+i,"is-left":i}})],1):e._e()],1)}),e.mappingRegistries.length>0?t("resizing-slider",{staticClass:"order2",attrs:{"is-column":!0}}):e._e(),e.mappingRegistries.length>0?t("div",{staticClass:"mappingTool order3",attrs:{id:"mappingTool"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.selected.scheme[!0]||e.selected.scheme[!1]||e.forceMappingBrowser&&e.$store.getters["mapping/getConcepts"]().length>0||!e.forceMappingBrowser,expression:"selected.scheme[true] || selected.scheme[false] || (forceMappingBrowser && $store.getters['mapping/getConcepts']().length > 0) || !forceMappingBrowser"}],staticClass:"mappingToolItem mainComponent visualComponent",attrs:{id:"mappingEditorComponent"}},[e.selected.scheme[!0]||e.selected.scheme[!1]||e.forceMappingBrowser&&e.$store.getters["mapping/getConcepts"]().length>0?t("mapping-editor"):t("div",{staticClass:"placeholderComponentCenter"},[t("div",{staticClass:"fontWeight-heavy fontSize-large"},[t("p",[e._v(e._s(e.$t("general.welcome")))]),t("p",[t("a",{attrs:{href:"./user-manual-"+e.locale+".html",target:"_blank"}},[e._v(e._s(e.$t("general.manual")))]),e._v(" - "),t("a",{attrs:{href:"https://gbv.github.io/cocoda/",target:"_blank"}},[e._v(e._s(e.$t("general.documentation")))]),e._v(" - "),t("a",{attrs:{href:"https://github.com/gbv/cocoda",target:"_blank"}},[e._v(e._s(e.$t("general.github")))])]),e.config.feedbackUrl?t("p",[t("br"),t("a",{attrs:{href:e.config.feedbackUrl,target:"_blank"}},[e._v(e._s(e.$t("general.feedback")))]),t("br"),e._v(" "+e._s(e.$t("general.feedback2"))+" ")]):e._e(),e.forceMappingBrowser?e._e():t("hr"),e.forceMappingBrowser?e._e():t("p",[e.$refs.mappingBrowser&&e.$refs.mappingBrowser.tabIndexes&&e.$refs.mappingBrowser.tabIndexes.concordances!=null?t("span",[t("a",{attrs:{href:""},on:{click:function(i){return i.preventDefault(),e.showConcordances.apply(null,arguments)}}},[e._v(e._s(e.$t("general.showConcordances")))]),e._v(" - ")]):e._e(),t("a",{attrs:{href:""},on:{click:function(i){return i.preventDefault(),e.showMappingSearch.apply(null,arguments)}}},[e._v(e._s(e.$t("general.showMappingSearch")))])])])]),t("minimizer",{directives:[{name:"show",rawName:"v-show",value:!e.forceMappingEditor,expression:"!forceMappingEditor"}],ref:"mappingEditorMinimizer",attrs:{name:"mappingEditorComponent",text:e.$t("mappingEditor.title"),"force-minimized":e.forceMappingEditor?!1:null}})],1),t("resizing-slider",{directives:[{name:"show",rawName:"v-show",value:(e.selected.scheme[!0]||e.selected.scheme[!1]||e.forceMappingBrowser)&&(e.selected.scheme[!0]||e.selected.scheme[!1]||e.forceMappingBrowser&&e.$store.getters["mapping/getConcepts"]().length>0||!e.forceMappingBrowser),expression:"(selected.scheme[true] || selected.scheme[false] || forceMappingBrowser) && (selected.scheme[true] || selected.scheme[false] || (forceMappingBrowser && $store.getters['mapping/getConcepts']().length > 0) || !forceMappingBrowser)"}],attrs:{"cocoda-red":!0}}),t("div",{directives:[{name:"show",rawName:"v-show",value:e.selected.scheme[!0]||e.selected.scheme[!1]||e.forceMappingBrowser,expression:"selected.scheme[true] || selected.scheme[false] || forceMappingBrowser"}],staticClass:"mappingToolItem mainComponent visualComponent",attrs:{id:"mappingBrowserComponent"}},[t("mapping-browser",{ref:"mappingBrowser"}),t("minimizer",{ref:"mappingBrowserMinimizer",attrs:{name:"mappingBrowserComponent",text:e.$t("mappingBrowser.title")}})],1)],1):e._e(),e.mappingRegistries.length>0?t("resizing-slider",{staticClass:"order4",attrs:{"is-column":!0}}):e._e()],2):e._e()])]:e._e()],2)},Li=[];Pe.ElementQueries.listen();const xi={name:"App",components:{TheNavbar:je,ConceptListWrapper:kt,ItemDetail:ei,MappingEditor:it,MappingBrowser:Ie,ResizingSlider:ri,LoadingIndicatorFull:z,Minimizer:R,ConceptSchemeSelection:$i},mixins:[q,g,v,De],data(){return{loaded:!1,loading:!1,itemDetailSettings:{left:{showTopConceptsInScheme:!1},right:{showTopConceptsInScheme:!1}},loadFromParametersOnce:r.once(this.loadFromParameters),forceMappingBrowser:!1,forceMappingEditor:!1,repeatLoadBuildInfo:null}},computed:{selectedConceptLeft(){return p(this.selected.concept[!0])},selectedSchemeRight(){return p(this.selected.scheme[!1])},selectedConceptRight(){return p(this.selected.concept[!1])},selectedSchemeLeft(){return p(this.selected.scheme[!0])},settingsLocale(){let e=this.$settings.locale;return(this.config.languages||[]).includes(e)||(e="en"),e}},watch:{$route({query:e},{query:s}){let t=["from","fromScheme","to","toScheme"],i=!1;for(let n of t){let o=s[n],a=e[n],l=o&&p({uri:o}),c=a&&p({uri:a});l&&c?this.$jskos.compareFast(l,c)||(i=!0):o!=a&&(i=!0)}i&&this.loadFromParameters()},selectedConceptLeft:{handler(e,s){r.isEqual(r.get(e,"prefLabel"),r.get(s,"prefLabel"))||this.insertPrefLabel(!0)},deep:!0},selectedSchemeRight(e,s){this.$jskos.compareFast(e,s)||r.delay(()=>{this.insertPrefLabel(!0)},50)},selectedConceptRight:{handler(e,s){r.isEqual(r.get(e,"prefLabel"),r.get(s,"prefLabel"))||this.insertPrefLabel(!1)},deep:!0},selectedSchemeLeft(e,s){this.$jskos.compareFast(e,s)||r.delay(()=>{this.insertPrefLabel(!1)},50)},locale(e,s){e!=s&&this.$store.commit({type:"settings/set",prop:"locale",value:e})},settingsLocale(e){e!=this.locale&&(this.$i18n.locale=e)},user(e,s){if(s!==void 0&&!s&&e){this.alert(this.$t("alerts.loggedIn"),null,"success");const t=this.getNameForIdentity();if(t&&this.$store.commit({type:"settings/set",prop:"creator",value:t}),this.localMappingsRegistry&&this.$jskos.compareFast(this.currentRegistry,this.localMappingsRegistry)){const i=this.config.registries.find(n=>this.$jskos.mappingRegistryIsStored(n)&&!this.$jskos.compareFast(n,this.localMappingsRegistry)&&n.isAuthorizedFor({type:"mappings",action:"create",user:e}));i&&(this.$store.commit({type:"settings/set",prop:"mappingRegistry",value:i.uri}),this.alert(this.$t("alerts.loggedInRegistryChanged",[this.$jskos.prefLabel(i)]),0,"warning",this.$t("alerts.loggedInRegistryChangedUndoButton"),n=>{this.$store.commit({type:"alerts/setCountdown",alert:n,countdown:0}),this.$store.commit({type:"settings/set",prop:"mappingRegistry",value:this.localMappingsRegistry.uri})}))}}else s&&!e?this.alert(this.$t("alerts.loggedOut"),10,"danger",this.$t("settings.logInButton"),()=>{const t=this.$refs.navbar;t&&t.openSettingsTab&&t.openSettingsTab(0)}):s&&e&&s&&s.name&&e&&e.name&&e.uri==this.creator.uri&&this.creatorName===s.name&&this.$store.commit({type:"settings/set",prop:"creator",value:e.name})},userUris(){this.userUris&&this.userUris.length&&(this.userUris.includes(this.creator.uri)||this.$store.commit({type:"settings/set",prop:"creatorUri",value:this.userUris[0]}))},forceMappingBrowser(e){if(e){const s=this.$refs.mappingBrowserMinimizer;s&&(s.minimized=!1)}},selected:{handler(){!this.selected.scheme[!0]&&!this.selected.scheme[!1]?this.forceMappingEditor=!0:this.forceMappingEditor=!1},deep:!0},isPageVisible(e){e?this.repeatLoadBuildInfo&&this.repeatLoadBuildInfo.start():this.repeatLoadBuildInfo&&this.repeatLoadBuildInfo.stop()},languages(){for(let e of this.$store.state.config.registries)e&&(e.languages=this.languages);r.delay(()=>{this.insertPrefLabel(!0),this.insertPrefLabel(!1)},100)}},created(){this.load(),setTimeout(async()=>{if(this.localMappingsRegistry){const e=await this.getMappings({registry:this.localMappingsRegistry,limit:1});e._totalCount&&e._totalCount>=500&&this.alert(this.$t("general.tooManyMappings",{count:e._totalCount}),0)}},1e4)},methods:{async load(){const e=new Date;this.loadingGlobal=!0,await this.$store.dispatch("loadConfig",r.get(this.$route,"query.config")),await this.$store.dispatch("settings/load"),this.config.auth&&await this.$store.dispatch("auth/init",this.config.auth),document.title=this.config.title,this.$i18n.locale=this.settingsLocale,await Ee(),this.favoriteConcepts.forEach(s=>L(s,{type:"concept"})),$(this.favoriteConcepts),await this.$store.dispatch("mapping/loadMappingTrash"),this.loaded=!0,this.loadingGlobal=!1,this.loadFromParametersOnce(!0),this.config.autoRefresh.update&&this.enableUpdateCheck();for(let s of this.config.registries)r.isArray(s.schemes)&&(s._jskos.schemes=s.schemes.map(t=>p(t)||t));this.$log.log(`Application loaded in ${(new Date-e)/1e3} seconds.`)},enableUpdateCheck(){this.repeatLoadBuildInfo=He.loadBuildInfo({url:"./build-info.json",buildInfo:this.config.buildInfo,interval:this.config.autoRefresh.update,callImmediately:!0,callback:(e,s,t)=>{!e&&t&&s.gitCommit!=t.gitCommit&&(this.alert(this.$t("alerts.newVersionText"),0,"warning",this.$t("alerts.newVersionLink"),()=>{location.reload(!0)}),this.repeatLoadBuildInfo&&this.repeatLoadBuildInfo.stop(),this.repeatLoadBuildInfo=null)}})},insertPrefLabel(e){if(!this.$settings.components.ConceptSchemeSelection.insertPrefLabel[!e])return;let s=this.$jskos.prefLabel(p(this.selected.concept[e]),{fallbackToUri:!1}),t=/^[\s\w]*\w/.exec(s);this.setConceptSearchQuery(e,t?t[0]:"")},setConceptSearchQuery(e,s,t){let i=r.get(this,`$refs.conceptSchemeSelection${e?"Right":"Left"}[0]`);i&&i.setConceptSearchQuery(s,t)},refresh(e){e=="minimize"&&(this.itemDetailSettings.left.showTopConceptsInScheme=this.conceptListLeft()!=null&&this.conceptListLeft().$el.dataset.minimized=="1",this.itemDetailSettings.right.showTopConceptsInScheme=this.conceptListRight()!=null&&this.conceptListRight().$el.dataset.minimized=="1")},conceptListLeft(){return Array.isArray(this.$refs.conceptListLeft)?this.$refs.conceptListLeft[0]:this.$refs.conceptListLeft},conceptListRight(){return Array.isArray(this.$refs.conceptListRight)?this.$refs.conceptListRight[0]:this.$refs.conceptListRight},swapSides(){let e=this.$route.query;e=Object.assign(e,{from:e.to,fromScheme:e.toScheme,to:e.from,toScheme:e.fromScheme}),this.$router.push({query:e}),this.loadFromParameters(),r.delay(()=>{this.insertPrefLabel(!0),this.insertPrefLabel(!1)},300);let s=t=>{let i=r.get(t,"__ISOPEN__.true",!1),n=r.get(t,"__ISOPEN__.false",!1);if(this.open(t,!0,n),this.open(t,!1,i),t.narrower&&!t.narrower.includes(null))for(let o of t.narrower)s(o)};for(let t of r.uniq([e.fromScheme,e.toScheme])){let i=r.get(J(t),"topConcepts");for(let n of i||[])s(n)}},async loadFromParameters(e=!1){this.loading=!0;const s=this.$route.query,t={scheme:{true:s.fromScheme,false:s.toScheme},concept:{true:s.from,false:s.to}},i=async o=>{let a=t.scheme[o],l=null;a&&(l=p({uri:a}));let c=null;l&&t.concept[o]&&(c=L({uri:t.concept[o]},{scheme:l,type:"concept"}));try{await this.setSelected({concept:c,scheme:l,isLeft:o,noQueryRefresh:!0,noLoading:!0})}catch(h){this.$log.warn(h)}},n=async()=>{if(s.mapping||s.mappingUri||s.mappingIdentifier){let o=null;if(s.mapping)try{o=this.adjustMapping(this.$jskos.normalize(JSON.parse(s.mapping)))}catch(h){this.$log.warn("Error decoding mapping from URL parameter:",h)}r.isEqual(o,{})&&(o=null);let a=[];try{s.mappingUri?a.push(await this.getMapping({uri:s.mappingUri})):s.mappingIdentifier&&(a=await this.getMappings({identifier:s.mappingIdentifier}))}catch(h){this.$log.warn("Error loading mapping from URL parameter:",h)}a=a.filter(Boolean);let l=o,c=null;a.length&&(c=a.find(h=>r.get(h,"_registry").isAuthorizedFor&&r.get(h,"_registry").isAuthorizedFor({type:"mappings",action:"create",user:this.user}))||a[0],l=l||this.adjustMapping(this.$jskos.copyDeep(c))),this.$store.commit({type:"mapping/set",mapping:l,original:c,noQueryRefresh:!0}),$(this.$jskos.conceptsOfMapping(l)),l&&e&&(this.forceMappingBrowser=!0)}};if(await Promise.all([i(!0),i(!1),n()]),this.loading=!1,ze(this.$store),e)if(s.search){let o=JSON.parse(s.search);this.forceMappingBrowser=!0,this.searchMappings(o)}else s.concordances!==void 0?this.showConcordances():(s.mappingUri||s.mappingIdentifier)&&(this.forceMappingBrowser=!0,this.searchMappings())},searchMappings(e){let s=this.$refs.mappingBrowser;s&&s.searchWithParams&&s.searchWithParams(e)},showMappingSearch(){this.forceMappingBrowser=!0,this.searchMappings({})},showConcordances(){let e=this.$refs.mappingBrowser;if(!e){this.$log.warn("Could not show concordances because MappingBrowser component was not found.");return}if(e.concordancesLoaded)e.tabIndexes.concordances!=null&&(this.forceMappingBrowser=!0,e.tab=e.tabIndexes.concordances);else{this.loadingGlobal=!0;let s;s=this.$watch(()=>e.concordancesLoaded,()=>{this.loadingGlobal=!1,e.tabIndexes.concordances!=null&&(this.forceMappingBrowser=!0,e.tab=e.tabIndexes.concordances),s&&s()})}}}},ye={};var Mi=d(xi,ki,Li,!1,Fi,null,null,null);function Fi(e){for(let s in ye)this[s]=ye[s]}var ji=function(){return Mi.exports}();const _e=We({store:Ae,router:Be,i18n:Re,render:()=>Ue(ji)});Te(_e);_e.mount("#app");
